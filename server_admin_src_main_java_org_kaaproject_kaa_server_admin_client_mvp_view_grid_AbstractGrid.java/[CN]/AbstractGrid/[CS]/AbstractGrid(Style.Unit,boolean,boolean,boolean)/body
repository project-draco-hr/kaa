{
  super(unit);
  ProvidesKey<T> keyProvider=new ProvidesKey<T>(){
    @Override public Object getKey(    T item){
      return item != null ? getObjectId(item) : null;
    }
  }
;
  this.enableActions=enableActions;
  this.embedded=embedded;
  this.editable=editable;
  Resources localGridResources=embedded ? gridResourcesSmall : gridResources;
  table=new DataGrid<T>(20,localGridResources,keyProvider);
  table.setAutoHeaderRefreshDisabled(true);
  Label emptyTableLabel=new Label(Utils.constants.dataGridEmpty());
  if (embedded) {
    emptyTableLabel.getElement().getStyle().setFontSize(14,Unit.PX);
    emptyTableLabel.getElement().getStyle().setColor("#999999");
  }
  table.setEmptyTableWidget(emptyTableLabel);
  selectionModel=new MultiSelectionModel<T>(keyProvider);
  table.setSelectionModel(selectionModel,DefaultSelectionEventManager.<T>createCheckboxManager());
  selectionModel.addSelectionChangeHandler(new SelectionChangeEvent.Handler(){
    @Override public void onSelectionChange(    SelectionChangeEvent event){
      table.redrawHeaders();
    }
  }
);
  prefferredWidth=initColumns(table);
  table.setMinimumTableWidth(prefferredWidth,Unit.PX);
  SimplePager.Resources localPagerResources=embedded ? pagerResourcesSmall : pagerResources;
  SimplePager pager=new SimplePager(TextLocation.CENTER,localPagerResources,false,0,true){
    @Override protected String createText(){
      HasRows display=getDisplay();
      Range range=display.getVisibleRange();
      int currentPage=range.getStart() / (range.getLength() != 0 ? range.getLength() : 1) + 1;
      int total=((int)Math.ceil((float)display.getRowCount() / (float)range.getLength()));
      if (total == 0) {
        total=1;
      }
      return Utils.messages.pagerText(currentPage,total);
    }
  }
;
  pager.setDisplay(table);
  String pagerId="pager_" + pager.hashCode();
  String html="<table " + "style='width:100%'>" + "  <tr>"+ "     <td"+ "       align='right'>"+ "        <div id='" + pagerId + "'/>"+ "     </td>"+ "  </tr>"+ "</table>";
  HTMLPanel htmlPanel=new HTMLPanel(html);
  htmlPanel.add(pager,pagerId);
  addNorth(htmlPanel,40);
  add(table);
  if (embedded) {
    getElement().getStyle().setProperty("boxShadow","0px 0px 8px rgba(0,0,0,0.5)");
    table.getElement().getStyle().setMargin(10,Unit.PX);
  }
 else {
    getElement().getStyle().setMargin(10,Unit.PX);
  }
}
