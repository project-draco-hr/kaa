{
  KaaClientState clientState=Mockito.mock(KaaClientState.class);
  Mockito.when(clientState.getPrivateKey()).thenReturn(clientKeys.getPrivate());
  Mockito.when(clientState.getPublicKey()).thenReturn(clientKeys.getPublic());
  KaaChannelManager channelManager=Mockito.mock(KaaChannelManager.class);
  DefaultOperationTcpChannel channel=new DefaultOperationTcpChannel(clientState,channelManager);
  ServerInfo server=IPTransportInfoTest.createTestServerInfo(ServerType.OPERATIONS,TransportIdConstants.TCP_TRANSPORT_ID,"www.test.fake",999,KeyUtil.generateKeyPair().getPublic());
  ConnectivityChecker checker=Mockito.mock(ConnectivityChecker.class);
  Mockito.when(checker.checkConnectivity()).thenReturn(false);
  channel.setConnectivityChecker(checker);
  channel.setServer(server);
  Mockito.verify(channelManager,Mockito.times(0)).onServerFailed(Mockito.any(ServerInfo.class));
}
