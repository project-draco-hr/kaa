{
synchronized (connection) {
    Statement statement=null;
    ResultSet rs=null;
    try {
      statement=connection.createStatement();
      rs=statement.executeQuery(PersistentLogStorageConstants.KAA_HOW_MANY_LOGS_IN_DB);
      if (rs.next()) {
        unmarkedRecordCount=totalRecordCount=rs.getLong(1);
        unmarkedConsumedSize=rs.getLong(2);
        LOG.trace("Retrieved record count: {}, consumed size: {}",totalRecordCount,unmarkedConsumedSize);
      }
 else {
        LOG.error("Unable to retrieve consumed size and volume");
        throw new RuntimeException("Unable to retrieve consumed size and volume");
      }
    }
  finally {
      tryCloseResultSet(rs);
      tryCloseStatement(statement);
    }
  }
}
