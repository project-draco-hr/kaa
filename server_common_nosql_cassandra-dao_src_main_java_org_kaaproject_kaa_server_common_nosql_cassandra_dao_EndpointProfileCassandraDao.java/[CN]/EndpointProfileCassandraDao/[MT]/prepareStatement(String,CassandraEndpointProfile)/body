{
  StringBuilder sb=new StringBuilder(q);
  if (pf.getVersion() == 0L) {
    sb.append(SEMICOLON);
  }
 else {
    sb.append(IF_CONDITION).append(pf.getVersion()).append(";");
  }
  String query=sb.toString();
  LOG.info("Get version {}",pf.getVersion());
  LOG.debug("Prepared query {}",query);
  PreparedStatement ps=statements.get(query);
  if (ps == null) {
    ps=getSession().prepare(query);
    statements.put(query,ps);
  }
  BoundStatement bs=ps.bind();
  bs.setList(EP_ECF_VERSION_STATE_PROPERTY,convertEventStateToUDT(pf.getEcfVersionStates()));
  bs.setBytes(EP_CONFIG_HASH_PROPERTY,pf.getConfigurationHash());
  bs.setBytes(EP_TOPIC_HASH_PROPERTY,pf.getTopicHash());
  bs.setInt(EP_SIMPLE_TOPIC_HASH_PROPERTY,pf.getSimpleTopicHash());
  bs.setList(EP_GROUP_STATE_PROPERTY,convertGroupStateToUDT(pf.getGroupStates()));
  bs.setInt(EP_SEQUENCE_NUMBER_PROPERTY,pf.getSequenceNumber());
  bs.setInt(EP_SERVER_PROFILE_VERSION_PROPERTY,pf.getServerProfileVersion());
  bs.setInt(EP_SYSTEM_NOTIFICATION_VERSION_PROPERTY,pf.getSystemNfVersion());
  bs.setInt(EP_NOTIFICATION_VERSION_PROPERTY,pf.getNotificationVersion());
  bs.setInt(EP_PROFILE_VERSION_PROPERTY,pf.getProfileVersion());
  bs.setBytes(EP_USER_CONFIG_HASH_PROPERTY,pf.getUserConfigurationHash());
  bs.setString(EP_SERVER_HASH_PROPERTY,pf.getServerHash());
  bs.setString(EP_USER_ID_PROPERTY,pf.getEndpointUserId());
  bs.setInt(EP_USER_NOTIFICATION_VERSION_PROPERTY,pf.getUserNfVersion());
  bs.setInt(EP_CONFIGURATION_VERSION_PROPERTY,pf.getConfigurationVersion());
  bs.setString(EP_ACCESS_TOKEN_PROPERTY,pf.getAccessToken());
  bs.setString(EP_PROFILE_PROPERTY,pf.getProfile());
  bs.setString(EP_SERVER_PROFILE_PROPERTY,pf.getServerProfile());
  bs.setList(EP_SUBSCRIPTIONS_PROPERTY,pf.getSubscriptions());
  bs.setBytes(EP_EP_KEY_HASH_PROPERTY,pf.getEndpointKeyHash());
  return bs;
}
