{
  for (  Notification notification : notifications) {
    try {
      Topic topic=findTopicById(notification.getTopicId());
      boolean hasOwner=false;
synchronized (optionalListeners) {
        List<NotificationListener> listeners=optionalListeners.get(topic.getId());
        if (listeners != null && !listeners.isEmpty()) {
          hasOwner=true;
          for (          NotificationListener listener : listeners) {
            notifyListeners(listener,topic,notification);
          }
        }
      }
      if (!hasOwner) {
synchronized (mandatoryListeners) {
          for (          NotificationListener listener : mandatoryListeners) {
            notifyListeners(listener,topic,notification);
          }
        }
      }
    }
 catch (    UnavailableTopicException e) {
      LOG.warn("Received notification for an unknown topic (id={})",notification.getTopicId());
    }
  }
}
