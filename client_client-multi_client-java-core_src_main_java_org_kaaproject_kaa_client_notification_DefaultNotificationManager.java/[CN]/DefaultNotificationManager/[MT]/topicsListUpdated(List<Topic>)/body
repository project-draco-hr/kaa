{
  Map<String,Topic> newTopics=new HashMap<String,Topic>();
synchronized (topics) {
    for (    Topic topic : list) {
      newTopics.put(topic.getId(),topic);
      if (topics.remove(topic.getId()) == null) {
        state.addTopic(topic);
      }
    }
synchronized (voluntaryListeners) {
      for (      Topic topic : topics.values()) {
        voluntaryListeners.remove(topic.getId());
        state.removeTopic(topic.getId());
      }
    }
    topics=newTopics;
  }
synchronized (topicsListeners) {
    for (    NotificationTopicListListener listener : topicsListeners) {
      listener.onListUpdated(list);
    }
  }
}
