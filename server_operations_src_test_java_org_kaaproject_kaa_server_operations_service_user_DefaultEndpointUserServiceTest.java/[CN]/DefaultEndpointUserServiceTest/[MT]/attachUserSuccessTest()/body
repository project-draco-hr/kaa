{
  UserAttachRequest request=new UserAttachRequest(EXTERNAL_USER_ID,USER_ACCESS_TOKEN);
  EndpointProfileDto profileMock=mock(EndpointProfileDto.class);
  when(profileMock.getApplicationId()).thenReturn(APPLICATION_ID);
  ApplicationDto appDto=new ApplicationDto();
  appDto.setTenantId(TEST_TENANT_ID);
  when(applicationService.findAppById(APPLICATION_ID)).thenReturn(appDto);
  when(endpointService.checkAccessToken(appDto,EXTERNAL_USER_ID,USER_ACCESS_TOKEN)).thenReturn(Boolean.TRUE);
  UserAttachResponse response=endpointUserService.attachUser(profileMock,request);
  assertNotNull(response);
  assertEquals(SyncStatus.SUCCESS,response.getResult());
}
