{
  try {
    ApplicationDto application=applicationService.findAppById(applicationId);
    if (application == null) {
      throw new TException("Application not found!");
    }
    LogSchemaDto logSchema=logSchemaService.findLogSchemaByAppIdAndVersion(applicationId,schemaVersion);
    if (logSchema == null) {
      throw new TException("Log schema not found!");
    }
    Schema recordWrapperSchema=RecordWrapperSchemaGenerator.generateRecordWrapperSchema(logSchema.getSchema());
    String libraryFileName=MessageFormatter.arrayFormat(SCHEMA_NAME_PATTERN,new Object[]{schemaVersion}).getMessage();
    String schemaInJson=recordWrapperSchema.toString(true);
    byte[] schemaData=schemaInJson.getBytes(StandardCharsets.UTF_8);
    FileData schema=new FileData();
    schema.setFileName(libraryFileName);
    schema.setData(schemaData);
    return schema;
  }
 catch (  Exception e) {
    LOG.error("Unable to get Record Structure Schema",e);
    throw new TException(e);
  }
}
