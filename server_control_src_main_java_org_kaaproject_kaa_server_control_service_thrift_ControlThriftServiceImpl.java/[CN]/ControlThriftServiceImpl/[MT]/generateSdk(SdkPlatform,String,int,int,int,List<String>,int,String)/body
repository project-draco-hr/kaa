{
  try {
    ApplicationDto application=applicationService.findAppById(applicationId);
    if (application == null) {
      throw new TException("Application not found!");
    }
    ProfileSchemaDto profileSchema=profileService.findProfileSchemaByAppIdAndVersion(applicationId,profileSchemaVersion);
    if (profileSchema == null) {
      throw new TException("Profile schema not found!");
    }
    ConfigurationSchemaDto configurationShema=configurationService.findConfSchemaByAppIdAndVersion(applicationId,configurationSchemaVersion);
    if (configurationShema == null) {
      throw new TException("Configuration schema not found!");
    }
    ConfigurationDto defaultConfiguration=configurationService.findDefaultConfigurationBySchemaId(configurationShema.getId());
    if (defaultConfiguration == null) {
      throw new TException("Default configuration not found!");
    }
    NotificationSchemaDto notificationSchema=notificationService.findNotificationSchemaByAppIdAndTypeAndVersion(applicationId,NotificationTypeDto.USER,notificationSchemaVersion);
    if (notificationSchema == null) {
      throw new TException("Notification schema not found!");
    }
    LogSchemaDto logSchema=logSchemaService.findLogSchemaByAppIdAndVersion(applicationId,logSchemaVersion);
    if (logSchema == null) {
      throw new TException("Log schema not found!");
    }
    DataSchema profileDataSchema=new DataSchema(profileSchema.getSchema());
    DataSchema notificationDataSchema=new DataSchema(notificationSchema.getSchema());
    ProtocolSchema protocolSchema=new ProtocolSchema(configurationShema.getProtocolSchema());
    DataSchema logDataSchema=new DataSchema(logSchema.getSchema());
    String appToken=application.getApplicationToken();
    String profileSchemaBody=profileDataSchema.getRawSchema();
    byte[] defaultConfigurationData=GenericAvroConverter.toRawData(defaultConfiguration.getBody(),configurationShema.getBaseSchema());
    List<EventFamilyMetadata> eventFamilies=new ArrayList<>();
    if (aefMapIds != null) {
      List<ApplicationEventFamilyMapDto> aefMaps=applicationEventMapService.findApplicationEventFamilyMapsByIds(aefMapIds);
      for (      ApplicationEventFamilyMapDto aefMap : aefMaps) {
        EventFamilyMetadata efm=new EventFamilyMetadata();
        efm.setVersion(aefMap.getVersion());
        efm.setEventMaps(aefMap.getEventMaps());
        EventClassFamilyDto ecf=eventClassService.findEventClassFamilyById(aefMap.getEcfId());
        efm.setEcfName(ecf.getName());
        efm.setEcfNamespace(ecf.getNamespace());
        efm.setEcfClassName(ecf.getClassName());
        List<EventSchemaVersionDto> ecfSchemas=ecf.getSchemas();
        for (        EventSchemaVersionDto ecfSchema : ecfSchemas) {
          if (ecfSchema.getVersion() == efm.getVersion()) {
            efm.setEcfSchema(ecfSchema.getSchema());
            break;
          }
        }
        eventFamilies.add(efm);
      }
    }
    SdkGenerator generator=SdkGeneratorFactory.createSdkGenerator(sdkPlatform);
    return generator.generateSdk(Version.PROJECT_VERSION,controlZKService.getCurrentBootstrapNodes(),appToken,profileSchemaVersion,configurationSchemaVersion,notificationSchemaVersion,logSchemaVersion,profileSchemaBody,notificationDataSchema.getRawSchema(),protocolSchema.getRawSchema(),configurationShema.getBaseSchema(),defaultConfigurationData,eventFamilies,logDataSchema.getRawSchema(),defaultVerifierToken);
  }
 catch (  Exception e) {
    LOG.error("Unable to generate SDK",e);
    throw new TException(e);
  }
}
