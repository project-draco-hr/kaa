{
  logAppender=new MongoDbLogAppender();
  LogAppenderDto appenderDto=new LogAppenderDto();
  appenderDto.setApplicationId(APPLICATION_ID);
  appenderDto.setApplicationToken(APPLICATION_TOKEN);
  appenderDto.setTenantId(TENANT_ID);
  appenderDto.setHeaderStructure(Arrays.asList(LogHeaderStructureDto.values()));
  LogAppenderParametersDto parameters=new LogAppenderParametersDto();
  CustomAppenderParametersDto customParameters=new CustomAppenderParametersDto();
  String dbName=MongoDBTestRunner.getDB().getName();
  List<ServerAddress> serverAddresses=MongoDBTestRunner.getDB().getMongo().getServerAddressList();
  List<MongoDbServer> servers=new ArrayList<>();
  for (  ServerAddress serverAddress : serverAddresses) {
    servers.add(new MongoDbServer(serverAddress.getHost(),serverAddress.getPort()));
  }
  MongoDbConfig mongoDbConfig=MongoDbConfig.newBuilder().setMongoServers(servers).setDbName(dbName).build();
  AvroByteArrayConverter<MongoDbConfig> converter=new AvroByteArrayConverter<>(MongoDbConfig.class);
  byte[] rawConfiguration=converter.toByteArray(mongoDbConfig);
  customParameters.setRawConfiguration(rawConfiguration);
  parameters.setParameters(customParameters);
  appenderDto.setProperties(parameters);
  logAppender.init(appenderDto);
}
