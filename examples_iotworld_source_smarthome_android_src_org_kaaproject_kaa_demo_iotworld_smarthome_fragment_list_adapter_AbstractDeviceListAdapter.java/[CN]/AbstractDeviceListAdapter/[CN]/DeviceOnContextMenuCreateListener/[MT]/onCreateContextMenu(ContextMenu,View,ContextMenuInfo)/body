{
  int position=mRecyclerView.getChildPosition(v);
  List<T> devices=mDeviceStore.getDevices(getDeviceType());
  if (devices != null) {
    mContextMenuDevice=devices.get(position);
    if (mContextMenuDevice != null && mContextMenuDevice.getDeviceInfo() != null) {
      menu.setHeaderTitle(v.getResources().getString(R.string.actions_for_device_title,mContextMenuDevice.getDeviceInfo().getName()));
      menu.add(Menu.NONE,R.id.ctx_menu_refresh_device,Menu.NONE,R.string.refresh);
      menu.add(Menu.NONE,R.id.ctx_menu_rename_device,Menu.NONE,R.string.rename);
      if (mContextMenuDevice instanceof AbstractGeoFencingDevice) {
        menu.add(Menu.NONE,R.id.ctx_menu_change_mode,Menu.NONE,R.string.change_mode);
      }
      menu.add(Menu.NONE,R.id.ctx_menu_detach_device,Menu.NONE,R.string.detach);
    }
  }
 else {
    mContextMenuDevice=null;
  }
}
