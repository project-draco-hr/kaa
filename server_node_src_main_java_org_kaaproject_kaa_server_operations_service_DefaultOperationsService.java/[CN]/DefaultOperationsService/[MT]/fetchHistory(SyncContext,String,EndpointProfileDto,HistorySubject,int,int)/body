{
  if (isFirstRequest(profile,subject)) {
    LOG.debug("[{}] Profile has no endpoint groups yet. calculating full list",context.getEndpointKey());
    return historyDeltaService.getDelta(profile,applicationToken,endSeqNumber);
  }
 else {
    LOG.debug("[{}] Profile has endpoint groups. Calculating changes",context.getEndpointKey());
    return historyDeltaService.getDelta(profile,subject,applicationToken,startSeqNumber,endSeqNumber);
  }
}
