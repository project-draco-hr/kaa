{
  final String dnsName=getDNSNameFromConnectionInfo(nodeInfo.getConnectionInfo());
  LOG.debug("Update bootstrap server: " + dnsName + " Thrift: "+ nodeInfo.getConnectionInfo().getThriftHost().toString()+ ":"+ nodeInfo.getConnectionInfo().getThriftPort());
  try {
    ThriftClient<BootstrapThriftService.Client> client=new ThriftClient<BootstrapThriftService.Client>(nodeInfo.getConnectionInfo().getThriftHost().toString(),nodeInfo.getConnectionInfo().getThriftPort(),BootstrapThriftService.Client.class);
    client.setThriftActivity(new ThriftActivity<BootstrapThriftService.Client>(){
      @Override public void isSuccess(      boolean activitySuccess){
        lastBootstrapServersUpdateFailed=!activitySuccess;
        LOG.info("Bootstrap {}: Operations servers list updated {}",dnsName,activitySuccess ? "successfully" : "unsuccessfully");
      }
      @Override public void doInTemplate(      Client t){
        try {
          Map<String,OperationsServer> update=new Hashtable<String,OperationsServer>();
          for (          String dnsName : opsServersMap.keySet()) {
            update.put(dnsName,opsServersMap.get(dnsName).opsServer);
          }
          t.onOperationsServerListUpdate(update);
          LOG.info("Bootstrap " + dnsName + " Operations servers list updated.");
        }
 catch (        TException e) {
          lastBootstrapServersUpdateFailed=true;
          LOG.error("Bootstrap " + dnsName + " Operations servers list updated failed: "+ e.toString());
        }
      }
    }
);
    ThriftExecutor.execute(client);
  }
 catch (  NoSuchMethodException|SecurityException|InstantiationException|IllegalAccessException|IllegalArgumentException|InvocationTargetException e) {
    lastBootstrapServersUpdateFailed=true;
    LOG.error("Bootstrap " + dnsName + " Operations servers list execute updated failed: "+ e.toString());
  }
}
