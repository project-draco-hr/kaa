{
  super.onResume();
  cameraManager=new CameraManager(getApplication());
  viewfinderView=(ViewfinderView)findViewById(R.id.viewfinder_view);
  viewfinderView.setCameraManager(cameraManager);
  resultView=findViewById(R.id.result_view);
  statusView=(TextView)findViewById(R.id.status_view);
  handler=null;
  lastResult=null;
  setRequestedOrientation(getCurrentOrientation());
  resetStatusView();
  SurfaceView surfaceView=(SurfaceView)findViewById(R.id.preview_view);
  SurfaceHolder surfaceHolder=surfaceView.getHolder();
  surfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
  if (hasSurface) {
    initCamera(surfaceHolder);
  }
 else {
    surfaceHolder.addCallback(this);
  }
  ambientLightManager.start(cameraManager);
  inactivityTimer.onResume();
  Intent intent=getIntent();
  source=IntentSource.NONE;
  decodeFormats=null;
  characterSet=null;
  if (intent != null) {
    String action=intent.getAction();
    if (Intents.Scan.ACTION.equals(action)) {
      source=IntentSource.NATIVE_APP_INTENT;
      decodeFormats=DecodeFormatManager.parseDecodeFormats(intent);
      if (intent.hasExtra(Intents.Scan.WIDTH) && intent.hasExtra(Intents.Scan.HEIGHT)) {
        int width=intent.getIntExtra(Intents.Scan.WIDTH,0);
        int height=intent.getIntExtra(Intents.Scan.HEIGHT,0);
        if (width > 0 && height > 0) {
          cameraManager.setManualFramingRect(width,height);
        }
      }
      if (intent.hasExtra(Intents.Scan.CAMERA_ID)) {
        int cameraId=intent.getIntExtra(Intents.Scan.CAMERA_ID,-1);
        if (cameraId >= 0) {
          cameraManager.setManualCameraId(cameraId);
        }
      }
      String customPromptMessage=intent.getStringExtra(Intents.Scan.PROMPT_MESSAGE);
      if (customPromptMessage != null) {
        statusView.setText(customPromptMessage);
      }
    }
    characterSet=intent.getStringExtra(Intents.Scan.CHARACTER_SET);
  }
}
