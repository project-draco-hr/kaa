{
  ApplicationDto application=generateApplication();
  EndpointGroupDto groupDto=generateEndpointGroup(application.getId());
  EndpointGroupDto groupDto2=generateEndpointGroup(application.getId());
  ProfileSchemaDto schema=generateProfSchema(application.getId(),1).get(0);
  ProfileFilterDto filterDto=generateFilter(schema.getId(),groupDto.getId(),1,false).get(0);
  Assert.assertNotNull(filterDto);
  profileService.removeProfileFiltersByProfileSchemaId(schema.getId());
  filterDto.setId(null);
  filterDto.setEndpointGroupId(groupDto.getId());
  ProfileFilterDto savedOne=profileService.saveProfileFilter(filterDto);
  Assert.assertNotNull(savedOne);
  ChangeProfileFilterNotification activeOne=profileService.activateProfileFilter(savedOne.getId(),null);
  Assert.assertNotNull(activeOne);
  filterDto.setId(null);
  filterDto.setEndpointGroupId(groupDto2.getId());
  ProfileFilterDto savedTwo=profileService.saveProfileFilter(filterDto);
  Assert.assertNotNull(savedTwo);
  ChangeProfileFilterNotification activeTwo=profileService.activateProfileFilter(savedTwo.getId(),null);
  Assert.assertNotNull(activeTwo);
  List<ProfileFilterDto> activeList=profileService.findProfileFilterByAppIdAndVersion(application.getId(),schema.getMajorVersion());
  Assert.assertFalse(activeList.isEmpty());
  Set<String> groupIds=new HashSet<>();
  for (  ProfileFilterDto dto : activeList) {
    Assert.assertEquals(dto.getStatus(),UpdateStatus.ACTIVE);
    groupIds.add(dto.getEndpointGroupId());
  }
  Assert.assertEquals(2,groupIds.size());
}
