{
  EndpointProfileDto profileDto=new EndpointProfileDto();
  profileDto.setEndpointKeyHash(generateString("TEST_KEY_HASH").getBytes());
  String appId=generateApplication().getId();
  profileDto.setApplicationId(appId);
  List<EndpointGroupStateDto> groupState=new ArrayList<>();
  groupState.add(new EndpointGroupStateDto(endpointGroupId,null,null));
  profileDto.setCfGroupStates(groupState);
  profileDto.setProfile("{\"title\": \"TEST\"}");
  if (nfGroupStateOnly) {
    profileDto.setNfGroupStates(groupState);
    profileDto.setCfGroupStates(null);
  }
 else {
    profileDto.setCfGroupStates(groupState);
  }
  profileDto.setSdkToken(UUID.randomUUID().toString());
  return endpointService.saveEndpointProfile(profileDto);
}
