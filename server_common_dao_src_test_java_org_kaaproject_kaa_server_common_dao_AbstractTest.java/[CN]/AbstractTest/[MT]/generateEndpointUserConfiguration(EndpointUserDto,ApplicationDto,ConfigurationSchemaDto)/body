{
  EndpointUserConfigurationDto configurationDto=new EndpointUserConfigurationDto();
  if (endpointUser == null) {
    endpointUser=generateEndpointUser(null);
  }
  if (applicationDto == null) {
    applicationDto=generateApplication();
  }
  configurationDto.setUserId(endpointUser.getId());
  if (configurationSchema == null) {
    configurationSchema=generateConfSchema(applicationDto.getId(),1).get(0);
  }
  configurationDto.setSchemaVersion(configurationSchema.getMajorVersion());
  configurationDto.setBody(UUID.randomUUID().toString());
  configurationDto.setAppToken(applicationDto.getApplicationToken());
  endpointUserConfigurationDao.save(configurationDto);
  return configurationDto;
}
