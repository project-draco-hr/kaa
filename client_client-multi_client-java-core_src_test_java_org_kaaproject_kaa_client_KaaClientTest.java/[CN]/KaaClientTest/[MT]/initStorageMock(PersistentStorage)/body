{
  KeyPair kp=KeyUtil.generateKeyPair();
  Mockito.when(storage.exists(KaaClientPropertiesState.CLIENT_PUBLIC_KEY_NAME_DEFAULT)).thenReturn(true);
  Mockito.when(storage.exists(KaaClientPropertiesState.CLIENT_PRIVATE_KEY_NAME_DEFAULT)).thenReturn(true);
  Mockito.when(storage.openForRead(KaaClientPropertiesState.CLIENT_PUBLIC_KEY_NAME_DEFAULT)).thenReturn(new ByteArrayInputStream(kp.getPublic().getEncoded()));
  Mockito.when(storage.openForRead(KaaClientPropertiesState.CLIENT_PRIVATE_KEY_NAME_DEFAULT)).thenReturn(new ByteArrayInputStream(kp.getPrivate().getEncoded()));
  Mockito.when(storage.openForWrite(Mockito.anyString())).thenReturn(Mockito.mock(OutputStream.class));
}
