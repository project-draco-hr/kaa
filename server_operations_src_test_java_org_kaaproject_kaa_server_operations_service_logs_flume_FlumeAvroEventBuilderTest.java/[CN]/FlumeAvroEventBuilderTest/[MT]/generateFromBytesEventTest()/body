{
  eventBuilder=new FlumeBytesEventBuilder();
  ReflectionTestUtils.setField(eventBuilder,"applicationService",applicationService);
  Mockito.when(applicationService.findAppById(APP_ID)).thenReturn(app);
  Event event=eventBuilder.generateEvent(eventPack,null);
  Assert.assertEquals(FlumeBytesEventBuilder.METADATA_SIZE_IN_BYTES + COUNT * 8,event.getBody().length);
  eventBuilder.generateEvent(eventPack,null);
  Mockito.verify(applicationService,Mockito.times(1)).findAppById(APP_ID);
}
