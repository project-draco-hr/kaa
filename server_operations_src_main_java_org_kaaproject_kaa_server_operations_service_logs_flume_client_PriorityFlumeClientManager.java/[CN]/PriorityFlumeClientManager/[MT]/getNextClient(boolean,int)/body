{
  Log.debug("Get next flume rpc client");
  RpcClient client=null;
  HostInfoDto host=null;
  if (isInit) {
    host=hosts.get(DEFAULT_POSITION);
  }
 else {
    if (++currentPosition >= hosts.size()) {
      host=hosts.get(DEFAULT_POSITION);
      currentPosition=DEFAULT_POSITION;
    }
 else {
      host=hosts.get(currentPosition);
    }
  }
  try {
    Log.warn("Initialize new flume client.");
    client=RpcClientFactory.getDefaultInstance(host.getHostname(),host.getPort());
  }
 catch (  FlumeException e) {
    Log.warn("Can't initialize flume client.",e);
    if (retryCount <= MAX_RETRY_COUNT) {
      client=getNextClient(false,++retryCount);
    }
 else {
      LOG.warn("Wasn't initialized any clients. Got exception {}",e);
      throw e;
    }
  }
  return client;
}
