{
  validateId(id,"Can't remove topic. Invalid topic id " + id);
  TopicDto topic=findTopicById(id);
  if (topic != null) {
    List<EndpointGroup> groups=endpointGroupDao.findEndpointGroupsByTopicIdAndAppId(topic.getApplicationId(),id);
    if (groups != null && !groups.isEmpty()) {
      for (      EndpointGroup eg : groups) {
        endpointService.removeTopicFromEndpointGroup(eg.getId(),id);
      }
    }
    notificationDao.removeNotificationsByTopicId(id);
    topicDao.removeById(id);
  }
}
