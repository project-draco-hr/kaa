{
  File propertiesFile=File.createTempFile("testApiCliClnt",null);
  Properties props=new Properties();
  props.put("thrift_host",HOST);
  props.put("thrift_port",PORT + "");
  FileOutputStream fos=new FileOutputStream(propertiesFile);
  props.store(fos,"");
  fos.close();
  ConsoleReader reader=Mockito.mock(ConsoleReader.class);
  Mockito.doReturn("disconnect; quit").when(reader).readLine(Mockito.any(String.class));
  ControlApiCliThriftClient cli=Mockito.spy(new ControlApiCliThriftClient());
  Mockito.doReturn(reader).when(cli).createReader();
  int result=cli.process(new String[]{"\\/\\/\\","----"});
  Assert.assertEquals(1,result);
  result=cli.process(new String[]{"-c","fake"});
  Assert.assertEquals(2,result);
  result=cli.process(new String[]{"-c",propertiesFile.getAbsolutePath()});
  Assert.assertEquals(-1,result);
  TestCluster.stop();
  result=cli.process(new String[]{"-c",propertiesFile.getAbsolutePath()});
  Assert.assertEquals(1,result);
  propertiesFile.delete();
}
