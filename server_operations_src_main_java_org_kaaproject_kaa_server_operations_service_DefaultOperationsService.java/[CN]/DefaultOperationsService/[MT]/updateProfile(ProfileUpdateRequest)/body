{
  LOG.debug("update endpoint. request: {}",request);
  String applicationToken=request.getApplicationToken().toString();
  EndpointObjectHash endpointKeyHash=EndpointObjectHash.fromBytes(toByteArray(request.getEndpointPublicKeyHash()));
  UpdateProfileRequest updateRequest=new UpdateProfileRequest(applicationToken,endpointKeyHash,request.getProfileBody().array(),request.getVersionInfo());
  EndpointProfileDto endpointProfile=profileService.updateProfile(updateRequest);
  LOG.debug("profile updated. id: {}, endpointKeyHash: {}",endpointProfile.getId(),endpointProfile.getEndpointKeyHash());
  SyncRequest syncRequest=toSyncRequest(request.getApplicationToken(),endpointProfile);
  syncRequest.setAcceptedUnicastNotifications(request.getAcceptedUnicastNotifications());
  syncRequest.setTopicStates(request.getTopicStates());
  SyncResponseHolder response=processSync(syncRequest,endpointProfile);
  LOG.debug("update endpoint. response: {}",response);
  return response;
}
