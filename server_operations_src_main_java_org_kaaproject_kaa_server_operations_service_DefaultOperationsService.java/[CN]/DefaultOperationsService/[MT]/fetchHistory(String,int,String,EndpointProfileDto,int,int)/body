{
  int curEndpointSeqNumber=Math.min(startSeqNumber,profile.getSequenceNumber());
  if (isFirstRequest(profile)) {
    LOG.debug("[{}] Profile has no endpoint groups yet. calculating full list",endpointId);
    return historyDeltaService.getDelta(profile,applicationToken,endSeqNumber);
  }
 else {
    LOG.debug("[{}] Profile has endpoint groups. Calculating changes",endpointId);
    return historyDeltaService.getDelta(profile,applicationToken,curEndpointSeqNumber,endSeqNumber);
  }
}
