{
  FileResponseExtractor extractor=new FileResponseExtractor(new File(destination));
  final List<MediaType> mediaTypes=Arrays.asList(MediaType.APPLICATION_JSON,MediaType.valueOf("application/*+json"));
  final HttpEntity<SdkPropertiesDto> requestEntity=new HttpEntity<>(key);
  RequestCallback request=new RequestCallback(){
    @SuppressWarnings("unchecked") @Override public void doWithRequest(    ClientHttpRequest httpRequest) throws IOException {
      httpRequest.getHeaders().setAccept(mediaTypes);
      Object requestBody=requestEntity.getBody();
      Class<?> requestType=requestBody.getClass();
      HttpHeaders requestHeaders=requestEntity.getHeaders();
      MediaType requestContentType=requestHeaders.getContentType();
      for (      HttpMessageConverter<?> messageConverter : restTemplate.getMessageConverters()) {
        if (messageConverter.canWrite(requestType,requestContentType)) {
          if (!requestHeaders.isEmpty()) {
            httpRequest.getHeaders().putAll(requestHeaders);
          }
          ((HttpMessageConverter<Object>)messageConverter).write(requestBody,requestContentType,httpRequest);
          return;
        }
      }
    }
  }
;
  restTemplate.execute(url + "sdk",HttpMethod.POST,request,extractor);
  logger.info("Downloaded sdk to file '{}'",extractor.getDestFile());
}
