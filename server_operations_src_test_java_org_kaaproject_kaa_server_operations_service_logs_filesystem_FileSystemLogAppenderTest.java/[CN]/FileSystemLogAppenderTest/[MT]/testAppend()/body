{
  FileSystemLogAppender appender=new FileSystemLogAppender("test");
  FileSystemLogEventService service=Mockito.mock(FileSystemLogEventService.class);
  ReflectionTestUtils.setField(appender,"fileSystemLogEventService",service);
  GenericAvroConverter<BasicEndpointProfile> converter=new GenericAvroConverter<BasicEndpointProfile>(BasicEndpointProfile.SCHEMA$);
  BasicEndpointProfile theLog=new BasicEndpointProfile("test");
  LogSchemaDto schemaDto=new LogSchemaDto();
  schemaDto.setSchema(BasicEndpointProfile.SCHEMA$.toString());
  LogSchema schema=new LogSchema(schemaDto);
  LogEvent logEvent=new LogEvent();
  logEvent.setLogData(converter.encode(theLog));
  LogEventPack logEventPack=new LogEventPack("endpointKey",System.currentTimeMillis(),schema,Collections.singletonList(logEvent));
  appender.doAppend(logEventPack);
  Mockito.verify(service).save(Mockito.anyListOf(LogEventDto.class),Mockito.any(Logger.class),Mockito.any(WriterAppender.class));
}
