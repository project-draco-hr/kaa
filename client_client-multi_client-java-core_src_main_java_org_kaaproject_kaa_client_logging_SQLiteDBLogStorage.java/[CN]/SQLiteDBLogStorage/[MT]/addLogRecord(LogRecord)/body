{
synchronized (connection) {
    LOG.trace("Adding new log record...");
    if (insertStatement == null) {
      try {
        insertStatement=connection.prepareStatement(KAA_INSERT_NEW_RECORD);
      }
 catch (      SQLException e) {
        LOG.error("Can't create an insert statement: {}",KAA_INSERT_NEW_RECORD,e);
        return;
      }
    }
    try {
      insertStatement.setBytes(1,record.getData());
      int affectedRows=insertStatement.executeUpdate();
      if (affectedRows == 1) {
        consumedSize+=record.getSize();
        recordCount++;
        LOG.trace("Added new log record, records: {}",recordCount);
      }
    }
 catch (    SQLException e) {
      LOG.error("Can't add a new record",e);
      return;
    }
  }
}
