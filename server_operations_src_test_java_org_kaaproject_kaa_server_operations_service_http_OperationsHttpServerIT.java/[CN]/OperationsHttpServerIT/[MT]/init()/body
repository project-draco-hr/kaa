{
  executor=Executors.newCachedThreadPool();
  config=new OperationsServerConfig();
  HttpChannelConfig httpChannelConfig=new HttpChannelConfig();
  httpChannelConfig.setChannelEnabled(true);
  httpChannelConfig.setBindInterface("localhost");
  httpChannelConfig.setPort(bindPort);
  httpChannelConfig.setClientMaxBodySize(MAX_HTTP_REQUEST_SIZE);
  httpChannelConfig.setExecutorThreadSize(3);
  httpChannelConfig.setServerInitializerClass("org.kaaproject.kaa.server.operations.service.http.TestEndPointServerInitializer");
  List<String> commands=new Vector<>();
  commands.add("org.kaaproject.kaa.server.operations.service.http.commands.SyncCommand");
  commands.add("org.kaaproject.kaa.server.operations.service.http.commands.LongSyncCommand");
  httpChannelConfig.setCommandList(commands);
  List<ServiceChannelConfig> channelList=new ArrayList<>();
  channelList.add(httpChannelConfig);
  config.setChannelList(channelList);
  config.setAkkaService(testAkkaService);
  KeyPairGenerator serverKeyGen;
  try {
    serverKeyGen=KeyPairGenerator.getInstance("RSA");
    serverKeyGen.initialize(2048);
    KeyPair servertKeyPair=serverKeyGen.genKeyPair();
    serverPrivateKey=servertKeyPair.getPrivate();
    serverPublicKey=servertKeyPair.getPublic();
  }
 catch (  NoSuchAlgorithmException e) {
    fail(e.toString());
  }
  bootstrapServiceMock=mock(DefaultOperationsBootstrapService.class);
  config.setOperationsBootstrapService(bootstrapServiceMock);
  keystoreServiceMock=mock(FileKeyStoreService.class);
  when(bootstrapServiceMock.getKeyStoreService()).thenReturn(keystoreServiceMock);
  when(keystoreServiceMock.getPublicKey()).thenReturn(serverPublicKey);
  when(keystoreServiceMock.getPrivateKey()).thenReturn(serverPrivateKey);
  when(bootstrapServiceMock.getCacheService()).thenReturn(testCacheService);
  when(bootstrapServiceMock.getOperationsService()).thenReturn(testEndpointService);
  testAkkaService.start();
}
