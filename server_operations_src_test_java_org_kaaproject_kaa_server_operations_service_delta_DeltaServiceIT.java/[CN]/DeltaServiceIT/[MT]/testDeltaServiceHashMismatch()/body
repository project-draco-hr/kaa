{
  byte[] wrongConf=Arrays.copyOf(endpointConfiguration.getConfiguration(),endpointConfiguration.getConfiguration().length);
  wrongConf[0]=(byte)(wrongConf[0] + 1);
  EndpointObjectHash newConfHash=EndpointObjectHash.fromSHA1(wrongConf);
  GetDeltaRequest request=new GetDeltaRequest(app.getApplicationToken(),EndpointObjectHash.fromSHA1(ENDPOINT_KEY),EndpointObjectHash.fromSHA1(PROFILE_BYTES),newConfHash,OLD_ENDPOINT_SEQ_NUMBER);
  request.setEndpointProfile(endpointProfile.toDto());
  List<EndpointGroupStateDto> changes=new ArrayList<>();
  changes.add(new EndpointGroupStateDto(egAllId,pfAllId,cfAllId));
  HistoryDelta historyDelta=new HistoryDelta(changes,true,false);
  GetDeltaResponse response=deltaService.getDelta(request,historyDelta,NEW_APPLICATION_SEQ_NUMBER);
  assertNotNull(response);
  assertEquals(GetDeltaResponse.GetDeltaResponseType.CONF_RESYNC,response.getResponseType());
  assertEquals(NEW_APPLICATION_SEQ_NUMBER,response.getSequenceNumber());
  assertNotNull(response.getDelta());
  assertNotNull(response.getDelta().getData());
}
