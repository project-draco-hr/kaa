{
  LOG.debug("Find endpoint profiles by endpoint group id [{}] ",pageLink.getEndpointGroupId());
  EndpointProfilesPageDto endpointProfilesPageDto=new EndpointProfilesPageDto();
  int lim=Integer.valueOf(pageLink.getLimit());
  List<MongoEndpointProfile> mongoEndpointProfileList=find(query(new Criteria().orOperator(where(EP_CF_GROUP_STATE + "." + ENDPOINT_GROUP_ID).is(pageLink.getEndpointGroupId()),where(EP_NF_GROUP_STATE + "." + ENDPOINT_GROUP_ID).is(pageLink.getEndpointGroupId()))).skip(Integer.parseInt(pageLink.getOffset())).limit(Integer.parseInt(pageLink.getLimit()) + 1));
  if (mongoEndpointProfileList.size() == (lim + 1)) {
    String offset=Integer.toString(lim + Integer.valueOf(pageLink.getOffset()));
    pageLink.setOffset(offset);
    mongoEndpointProfileList.remove(lim);
  }
 else {
    pageLink.setNext(DaoConstants.LAST_PAGE_MESSAGE);
  }
  endpointProfilesPageDto.setPageLinkDto(pageLink);
  endpointProfilesPageDto.setEndpointProfiles(convertDtoList(mongoEndpointProfileList));
  return endpointProfilesPageDto;
}
