{
  buffer.put(FIXED_HEADER_CONST);
  if (getAesSessionKey() != null) {
    buffer.put(CONNECT_SESSION_KEY_FLAGS);
  }
 else {
    buffer.put((byte)0);
  }
  if (getSignature() != null) {
    buffer.put(CONNECT_SIGNATURE_FLAGS);
  }
 else {
    buffer.put((byte)0);
  }
  byte ka1=(byte)((keepAlive >> 8) & 0x000000FF);
  buffer.put(ka1);
  byte ka2=(byte)(keepAlive & 0x000000FF);
  buffer.put(ka2);
}
