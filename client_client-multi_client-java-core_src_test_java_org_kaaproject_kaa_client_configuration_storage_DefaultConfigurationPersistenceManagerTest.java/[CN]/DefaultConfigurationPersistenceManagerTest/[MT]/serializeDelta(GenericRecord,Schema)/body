{
  ByteArrayOutputStream stream=new ByteArrayOutputStream();
  Encoder encoder=EncoderFactory.get().binaryEncoder(stream,null);
  DatumWriter<GenericArray> writer=new GenericDatumWriter<GenericArray>(schema);
  GenericArray<GenericRecord> deltaArray=new GenericData.Array<GenericRecord>(1,schema);
  GenericRecord deltaT=new GenericData.Record(schema.getElementType());
  deltaT.put("delta",delta);
  deltaArray.add(deltaT);
  try {
    writer.write(deltaArray,encoder);
    encoder.flush();
  }
 catch (  IOException e) {
  }
  return stream.toByteArray();
}
