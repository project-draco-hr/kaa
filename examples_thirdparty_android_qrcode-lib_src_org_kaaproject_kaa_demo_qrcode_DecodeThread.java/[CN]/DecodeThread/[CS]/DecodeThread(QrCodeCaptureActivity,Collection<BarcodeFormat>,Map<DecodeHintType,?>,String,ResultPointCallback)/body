{
  this.activity=activity;
  handlerInitLatch=new CountDownLatch(1);
  hints=new EnumMap<>(DecodeHintType.class);
  if (baseHints != null) {
    hints.putAll(baseHints);
  }
  if (decodeFormats == null || decodeFormats.isEmpty()) {
    decodeFormats=EnumSet.noneOf(BarcodeFormat.class);
    decodeFormats.addAll(DecodeFormatManager.PRODUCT_FORMATS);
    decodeFormats.addAll(DecodeFormatManager.INDUSTRIAL_FORMATS);
    decodeFormats.addAll(DecodeFormatManager.QR_CODE_FORMATS);
    decodeFormats.addAll(DecodeFormatManager.DATA_MATRIX_FORMATS);
    decodeFormats.addAll(DecodeFormatManager.AZTEC_FORMATS);
    decodeFormats.addAll(DecodeFormatManager.PDF417_FORMATS);
  }
  hints.put(DecodeHintType.POSSIBLE_FORMATS,decodeFormats);
  if (characterSet != null) {
    hints.put(DecodeHintType.CHARACTER_SET,characterSet);
  }
  hints.put(DecodeHintType.NEED_RESULT_POINT_CALLBACK,resultPointCallback);
  Log.i("DecodeThread","Hints: " + hints);
}
