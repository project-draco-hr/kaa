{
  LOG.info("DefaultRebalancer recalculate Operations servers balance...");
  Map<String,RedirectionRule> rules=new HashMap<String,RedirectionRule>();
  if (opsServerLoadHistory.size() > 1) {
    String highestLoadName="";
    int highestLoadValue=0;
    String lowestLoadName="";
    int lowestLoadValue=Integer.MAX_VALUE;
    int averageLoad=0;
    for (    String opsServer : opsServerLoadHistory.keySet()) {
      if (opsServerLoadHistory.get(opsServer) != null) {
        List<OperationsServerLoad> load=opsServerLoadHistory.get(opsServer).getHistory();
        int p=load.get(load.size()).getProcessedRequestCount();
        if (p > highestLoadValue) {
          highestLoadValue=p;
          highestLoadName=opsServer;
        }
        if (p < lowestLoadValue) {
          lowestLoadName=opsServer;
          lowestLoadValue=p;
        }
        averageLoad+=p;
      }
    }
    averageLoad=averageLoad / opsServerLoadHistory.size();
    if (averageLoad > minRequestCount) {
      if (((highestLoadValue * 20) / 100) > lowestLoadValue) {
        RedirectionRule rule=new RedirectionRule();
        rule.setDnsName(lowestLoadName);
        rule.setRedirectionProbability(0.2);
        rule.setRuleTTL(300000);
        rules.put(highestLoadName,rule);
      }
    }
  }
  return rules;
}
