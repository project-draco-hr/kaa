{
  View rootView=inflater.inflate(R.layout.fragment_qrcode,container,false);
  Bundle args=this.getArguments();
  String contents=args.getString(QR_CONTENTS);
  String contentsDesc=args.getString(QR_CONTENTS_DESCRIPTION);
  WindowManager manager=(WindowManager)getActivity().getSystemService(Activity.WINDOW_SERVICE);
  Display display=manager.getDefaultDisplay();
  int width=display.getWidth();
  int height=display.getHeight();
  int smallerDimension=width < height ? width : height;
  smallerDimension=smallerDimension * 7 / 8;
  qrCodeEncoder=new QRCodeEncoder(contents,smallerDimension);
  try {
    Bitmap bitmap=qrCodeEncoder.encodeAsBitmap();
    if (bitmap == null) {
      Log.w(TAG,"Could not encode barcode");
      showErrorMessage(R.string.msg_encode_contents_failed);
      qrCodeEncoder=null;
      return rootView;
    }
    ImageView view=(ImageView)rootView.findViewById(R.id.image_view);
    view.setImageBitmap(bitmap);
    TextView contentsView=(TextView)rootView.findViewById(R.id.contents_text_view);
    contentsView.setText(contentsDesc);
  }
 catch (  WriterException e) {
    Log.w(TAG,"Could not encode barcode",e);
    showErrorMessage(R.string.msg_encode_contents_failed);
    qrCodeEncoder=null;
  }
  return rootView;
}
