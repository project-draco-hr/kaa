{
  Header signatureHeader=response.getFirstHeader(CommonEPConstans.SIGNATURE_HEADER_NAME);
  HttpEntity resEntity=response.getEntity();
  if (resEntity != null && signatureHeader != null) {
    byte[] body=EntityUtils.toByteArray(resEntity);
    byte[] signature=Base64.decodeBase64(signatureHeader.getValue());
    EntityUtils.consume(resEntity);
    if (!verificationEnabled || messageEncDec.verify(body,signature)) {
      return body;
    }
 else {
      throw new SecurityException("message can't be verified");
    }
  }
 else {
    throw new IOException("can't read message");
  }
}
