{
  if (!closed) {
    if (streamWriter != null) {
      final String appToken=this.getApplicationToken();
      LOG.debug("[{}] appending {} logs to cdap stream",this.getApplicationToken(),logEventPack.getEvents().size());
      for (      LogEventDto dto : generateLogEvent(logEventPack,header)) {
        StringBuilder sb=new StringBuilder();
        sb.append("{\"header\":").append(dto.getHeader()).append(",");
        sb.append("\"event\":").append(dto.getEvent()).append("}");
        ListenableFuture<Void> result=streamWriter.write(sb.toString(),UTF8);
        Futures.addCallback(result,new Callback(appToken),callbackExecutor);
      }
    }
 else {
      LOG.info("[{}] Attempted to append to empty streamWriter.",getName());
    }
  }
 else {
    LOG.info("[{}] Attempted to append to closed appender.",getName());
  }
}
