{
  try {
    streamClient=initStreamClient(configuration);
    Integer callbackPoolSize=configuration.getCallbackThreadPoolSize();
    if (callbackPoolSize == null) {
      callbackPoolSize=DEFAULT_CALLBACK_THREAD_POOL_SIZE;
    }
    callbackPoolSize=Math.min(callbackPoolSize,MAX_CALLBACK_THREAD_POOL_SIZE);
    callbackExecutor=Executors.newFixedThreadPool(callbackPoolSize);
    if (configuration.getStream() != null) {
      streamWriter=streamClient.createWriter(configuration.getStream());
    }
 else {
      throw new IllegalArgumentException("Stream parameter is not set!");
    }
  }
 catch (  Exception e) {
    LOG.error("Failed to init stream client: ",e);
  }
}
