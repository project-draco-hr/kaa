{
  byte[] requestKeyEncoded=messageEncDec.getEncodedSessionKey();
  byte[] requestBodyEncoded=messageEncDec.encodeData(body);
  byte[] signature=messageEncDec.sign(requestBodyEncoded);
  if (LOG.isTraceEnabled()) {
    LOG.trace("Signature size: {}",signature.length);
    LOG.trace(MessageEncoderDecoder.bytesToHex(signature));
    LOG.trace("RequestKeyEncoded size: {}",requestKeyEncoded.length);
    LOG.trace(MessageEncoderDecoder.bytesToHex(requestKeyEncoded));
    LOG.trace("RequestBodyEncoded size: {}",requestBodyEncoded.length);
    LOG.trace(MessageEncoderDecoder.bytesToHex(requestBodyEncoded));
  }
  LinkedHashMap<String,byte[]> requestEntity=new LinkedHashMap<String,byte[]>();
  requestEntity.put(CommonEPConstans.REQUEST_SIGNATURE_ATTR_NAME,signature);
  requestEntity.put(CommonEPConstans.REQUEST_KEY_ATTR_NAME,requestKeyEncoded);
  requestEntity.put(CommonEPConstans.REQUEST_DATA_ATTR_NAME,requestBodyEncoded);
  return requestEntity;
}
