{
  PublicKey endpointKey=null;
  if (request.getProfileSyncRequest() != null && request.getProfileSyncRequest().getEndpointPublicKey() != null) {
    byte[] publicKeySrc=request.getProfileSyncRequest().getEndpointPublicKey().array();
    endpointKey=KeyUtil.getPublic(publicKeySrc);
  }
  if (endpointKey == null) {
    EndpointObjectHash hash=getEndpointObjectHash(request);
    endpointKey=cacheService.getEndpointKey(hash);
  }
  return endpointKey;
}
