{
  try {
    EndpointGroupDto endpointGroup=null;
    if (edit) {
      String endpointGroupId=line.getOptionValue("i");
      endpointGroup=toDto(client.getEndpointGroup(endpointGroupId));
      if (endpointGroup == null) {
        writer.println("Endpoint Group with id " + endpointGroupId + NOT_FOUND);
        return;
      }
    }
 else {
      endpointGroup=new EndpointGroupDto();
    }
    if (line.hasOption("n")) {
      endpointGroup.setName(line.getOptionValue("n"));
    }
    if (line.hasOption("a")) {
      endpointGroup.setApplicationId(line.getOptionValue("a"));
    }
    if (line.hasOption("w")) {
      String weightStr=line.getOptionValue("w");
      Integer weight;
      try {
        weight=Integer.valueOf(weightStr);
      }
 catch (      NumberFormatException nfe) {
        errorWriter.println("Unable to parse weight option!");
        return;
      }
      endpointGroup.setWeight(weight);
    }
    EndpointGroupDto savedEndpointGroup=toDto(client.editEndpointGroup(toDataStruct(endpointGroup)));
    if (edit) {
      writer.println("Endpoint Group updated.");
    }
 else {
      writer.println("Created new Endpoint Group with id: " + savedEndpointGroup.getId());
      if (line.hasOption("o")) {
        String outFileName=line.getOptionValue("o");
        storeInfo(outFileName,savedEndpointGroup.getId(),errorWriter);
      }
    }
  }
 catch (  TException e) {
    handleException(UNABLE_TO + (edit ? UPDATE : CREATE) + ENDPOINT_GROUP,e,errorWriter);
  }
}
