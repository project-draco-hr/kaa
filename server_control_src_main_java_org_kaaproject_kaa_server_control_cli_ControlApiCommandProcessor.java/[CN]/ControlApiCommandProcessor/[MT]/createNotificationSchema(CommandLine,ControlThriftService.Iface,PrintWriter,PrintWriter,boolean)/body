{
  try {
    NotificationSchemaDto notificationSchemaDto;
    if (edit) {
      String notificationSchemaId=line.getOptionValue("i");
      notificationSchemaDto=toDto(client.getNotificationSchema(notificationSchemaId));
      if (notificationSchemaDto == null) {
        writer.println("Notification Schema with id " + notificationSchemaId + NOT_FOUND);
        return;
      }
    }
 else {
      notificationSchemaDto=new NotificationSchemaDto();
    }
    if (line.hasOption("a")) {
      String applicationId=line.getOptionValue("a");
      if (StringUtils.isNotBlank(applicationId)) {
        notificationSchemaDto.setApplicationId(applicationId);
      }
 else {
        errorWriter.println("Invalid application id for notification.");
        return;
      }
    }
    if (line.hasOption("t")) {
      String type=line.getOptionValue("t");
      if (StringUtils.isNotBlank(type)) {
        NotificationTypeDto typeDto;
        try {
          typeDto=NotificationTypeDto.valueOf(type);
        }
 catch (        IllegalArgumentException ex) {
          LOG.error("Incorrect type of notification {}",ex);
          return;
        }
        notificationSchemaDto.setType(typeDto);
      }
 else {
        errorWriter.println("Empty type of notification");
        return;
      }
    }
    if (line.hasOption("f")) {
      String schemaFile=line.getOptionValue("f");
      String schema=readFile(schemaFile,errorWriter);
      if (StringUtils.isNotBlank(schema)) {
        notificationSchemaDto.setSchema(new KaaSchemaFactoryImpl().createDataSchema(schema).getRawSchema());
      }
 else {
        errorWriter.println(CANT_READ_FILE);
        return;
      }
    }
 else     if (line.hasOption("b")) {
      String body=line.getOptionValue("b");
      notificationSchemaDto.setSchema(new KaaSchemaFactoryImpl().createDataSchema(body).getRawSchema());
    }
 else {
      errorWriter.println("Need to set body or file with body for notification schema");
      return;
    }
    NotificationSchemaDto savedNotificationSchema=toDto(client.editNotificationSchema(toDataStruct(notificationSchemaDto)));
    if (edit) {
      writer.println("Notification Schema updated.");
    }
 else {
      writer.println("Created new Notification Schema with id: " + savedNotificationSchema.getId());
      if (line.hasOption("o")) {
        String outFileName=line.getOptionValue("o");
        storeInfo(outFileName,savedNotificationSchema.getId(),errorWriter);
      }
    }
  }
 catch (  TException e) {
    handleException(UNABLE_TO + (edit ? UPDATE : CREATE) + NOTIFICATION,e,errorWriter);
  }
}
