{
  BluetoothSocket socket;
  try {
    socket=device.createRfcommSocketToServiceRecord(uuid);
    Log.i(TAG,"BT: canceling discovery...");
    boolean result=getmBluetoothAdapter().cancelDiscovery();
    Log.i(TAG,"BT: cancel discovery result: " + result);
    socket.connect();
    Log.i(TAG,"BT: connected using service record.");
    setSocket(socket);
  }
 catch (  IOException e) {
    Log.e(TAG,"BT: connect failed: " + e.getMessage());
    try {
      socket=BluetoothNativeHelper.createRfcommSocket(device,1);
      socket.connect();
      Log.i(TAG,"BT: connected using channel 1.");
      setSocket(socket);
    }
 catch (    Exception e1) {
      if (getCallback() != null) {
        getCallback().onError(e1);
      }
    }
  }
}
