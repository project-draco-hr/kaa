{
  endpointKeyHash=UUID.randomUUID().toString();
  appToken=String.valueOf(RANDOM.nextInt(Integer.MAX_VALUE));
  appenderDto=new LogAppenderDto();
  appenderDto.setId("Test_id");
  appenderDto.setApplicationToken(appToken);
  appenderDto.setName("Test Name");
  appenderDto.setTenantId(String.valueOf(RANDOM.nextInt()));
  appenderDto.setHeaderStructure(Arrays.asList(LogHeaderStructureDto.values()));
  appenderDto.setApplicationToken(appToken);
  header=new RecordHeader();
  header.setApplicationToken(appToken);
  header.setEndpointKeyHash(endpointKeyHash);
  header.setHeaderVersion(1);
  header.setTimestamp(System.currentTimeMillis());
  logEventPack=new LogEventPack();
  logEventPack.setDateCreated(System.currentTimeMillis());
  logEventPack.setEndpointKey(endpointKeyHash);
  CassandraServer server=new CassandraServer("127.0.0.1",9142);
  configuration=new CassandraConfig();
  configuration.setCassandraBatchType(CassandraBatchType.UNLOGGED);
  configuration.setKeySpace(KEY_SPACE_NAME);
  configuration.setTableNamePattern("logs_$app_token_$config_hash");
  configuration.setCassandraExecuteRequestType(CassandraExecuteRequestType.SYNC);
  configuration.setCassandraServers(Arrays.asList(server));
  List<ColumnMappingElement> columnMapping=new ArrayList<ColumnMappingElement>();
  columnMapping.add(new ColumnMappingElement(ColumnMappingElementType.HEADER_FIELD,"applicationToken","application_token",ColumnType.TEXT,true,false));
  columnMapping.add(new ColumnMappingElement(ColumnMappingElementType.UUID,"","id",ColumnType.UUID,true,false));
  columnMapping.add(new ColumnMappingElement(ColumnMappingElementType.HEADER_FIELD,"timestamp","timestamp",ColumnType.BIGINT,false,true));
  columnMapping.add(new ColumnMappingElement(ColumnMappingElementType.UUID,"","random_id",ColumnType.UUID,false,true));
  columnMapping.add(new ColumnMappingElement(ColumnMappingElementType.HEADER_JSON,"","header_json",ColumnType.TEXT,false,false));
  columnMapping.add(new ColumnMappingElement(ColumnMappingElementType.EVENT_JSON,"","event_json",ColumnType.TEXT,false,false));
  columnMapping.add(new ColumnMappingElement(ColumnMappingElementType.HEADER_BINARY,"","header_binary",ColumnType.BLOB,false,false));
  columnMapping.add(new ColumnMappingElement(ColumnMappingElementType.EVENT_BINARY,"","event_binary",ColumnType.BLOB,false,false));
  configuration.setColumnMapping(columnMapping);
  List<ClusteringElement> clusteringMapping=new ArrayList<ClusteringElement>();
  clusteringMapping.add(new ClusteringElement("timestamp",OrderType.DESC));
  clusteringMapping.add(new ClusteringElement("random_id",OrderType.DESC));
  configuration.setClusteringMapping(clusteringMapping);
  AvroByteArrayConverter<CassandraConfig> converter=new AvroByteArrayConverter<>(CassandraConfig.class);
  byte[] rawConfiguration=converter.toByteArray(configuration);
  appenderDto.setRawConfiguration(rawConfiguration);
  logAppender=new CassandraLogAppender();
  logAppender.init(appenderDto);
  logAppender.setApplicationToken(appToken);
}
