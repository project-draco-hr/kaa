{
  if (root.get("type").equals("array")) {
    processArray(root);
  }
 else   if (root.get("fields") != null) {
    processRecord(root);
  }
 else   if (root.get("type").equals("map")) {
    throw new SchemaCreationException("Map is not supported");
  }
}
