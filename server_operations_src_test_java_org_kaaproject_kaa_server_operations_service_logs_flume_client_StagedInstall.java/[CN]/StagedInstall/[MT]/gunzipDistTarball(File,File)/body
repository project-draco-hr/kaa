{
  File tarFile=null;
  InputStream tarballInputStream=null;
  OutputStream tarFileOutputStream=null;
  try {
    tarballInputStream=new GZIPInputStream(new FileInputStream(tarballFile));
    File temp2File=File.createTempFile("flume","-bin",destDir);
    String temp2FilePath=temp2File.getCanonicalPath();
    temp2File.delete();
    tarFile=new File(temp2FilePath + ".tar");
    LOGGER.info("Tarball being unzipped to: " + tarFile.getCanonicalPath());
    tarFileOutputStream=new FileOutputStream(tarFile);
    int length=0;
    byte[] buffer=new byte[10240];
    while ((length=tarballInputStream.read(buffer,0,10240)) != -1) {
      tarFileOutputStream.write(buffer,0,length);
    }
  }
 catch (  Exception ex) {
    LOGGER.error("Exception caught while unpacking the tarball",ex);
    throw ex;
  }
 finally {
    if (tarballInputStream != null) {
      try {
        tarballInputStream.close();
      }
 catch (      Exception ex) {
        LOGGER.warn("Unable to close input stream to tarball",ex);
      }
    }
    if (tarFileOutputStream != null) {
      try {
        tarFileOutputStream.close();
      }
 catch (      Exception ex) {
        LOGGER.warn("Unable to close tarfile output stream",ex);
      }
    }
  }
  return tarFile;
}
