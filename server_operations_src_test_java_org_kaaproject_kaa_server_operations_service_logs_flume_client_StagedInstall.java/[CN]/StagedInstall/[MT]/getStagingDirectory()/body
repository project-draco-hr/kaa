{
  File targetDir=new File("target");
  if (!targetDir.exists() || !targetDir.isDirectory()) {
    targetDir=new File(System.getProperty("java.io.tmpdir"));
  }
  File testDir=new File(targetDir,"test");
  testDir.mkdirs();
  File tempFile=File.createTempFile("flume","_stage",testDir);
  String absFileName=tempFile.getCanonicalPath();
  tempFile.delete();
  File stageDir=new File(absFileName + "_dir");
  if (stageDir.exists()) {
    throw new Exception("Stage directory exists: " + stageDir.getCanonicalPath());
  }
  stageDir.mkdirs();
  LOGGER.info("Staging Directory: " + stageDir.getCanonicalPath());
  return stageDir;
}
