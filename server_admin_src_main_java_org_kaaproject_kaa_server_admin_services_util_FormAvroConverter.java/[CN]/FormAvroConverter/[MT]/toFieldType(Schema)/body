{
switch (schema.getType()) {
case RECORD:
    return FieldType.RECORD;
case STRING:
  return FieldType.STRING;
case INT:
return FieldType.INTEGER;
case LONG:
return FieldType.LONG;
case BOOLEAN:
return FieldType.BOOLEAN;
case ENUM:
return FieldType.ENUM;
case ARRAY:
return FieldType.ARRAY;
case UNION:
if (isNullTypeSchema(schema)) {
for (Schema typeSchema : schema.getTypes()) {
FieldType type=toFieldType(typeSchema);
if (type != null) {
return type;
}
}
throw new UnsupportedOperationException("Unsupported avro field type: " + schema.getType());
}
 else {
return FieldType.UNION;
}
case NULL:
return null;
default :
throw new UnsupportedOperationException("Unsupported avro field type: " + schema.getType());
}
}
