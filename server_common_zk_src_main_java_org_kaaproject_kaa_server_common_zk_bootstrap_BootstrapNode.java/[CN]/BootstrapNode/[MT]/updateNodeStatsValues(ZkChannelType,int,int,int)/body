{
  LOG.trace("Bootstrap Node update statistics for {} channel",channelType.toString());
  for (  BootstrapSupportedChannel channel : nodeInfo.getSupportedChannelsArray()) {
    if (channel.getZkChannel().getChannelType().equals(channelType)) {
      BaseStatistics stats=null;
switch (channelType) {
case HTTP:
        ZkHttpStatistics zkHttpStats=(ZkHttpStatistics)channel.getZkChannel().getChannelStatistics();
      stats=zkHttpStats.getZkStatistics();
    break;
case HTTP_LP:
  ZkHttpLpStatistics zkHttpLpStats=(ZkHttpLpStatistics)channel.getZkChannel().getChannelStatistics();
stats=zkHttpLpStats.getZkStatistics();
break;
case KAATCP:
ZkKaaTcpStatistics zkTcpStats=(ZkKaaTcpStatistics)channel.getZkChannel().getChannelStatistics();
stats=zkTcpStats.getZkStatistics();
break;
}
if (stats != null) {
stats.setDeltaCalculationCount(deltaCalculationCount);
stats.setProcessedRequestCount(processedRequestCount);
stats.setRegisteredUsersCount(registeredUsersCount);
try {
client.setData().forPath(nodePath,bootstrapNodeAvroConverter.get().toByteArray(nodeInfo));
LOG.trace("Bootstrap Node update statistics for {} channel, data set: {},{},{}",channelType.toString(),deltaCalculationCount,processedRequestCount,registeredUsersCount);
}
 catch (Exception e) {
LOG.error("Unknown Error",e);
close();
}
}
break;
}
}
}
