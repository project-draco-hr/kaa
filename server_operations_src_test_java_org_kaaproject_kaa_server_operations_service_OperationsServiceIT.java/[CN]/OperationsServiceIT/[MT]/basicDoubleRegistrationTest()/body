{
  byte[] profile=avroConverter.encode(ENDPOINT_PROFILE);
  SyncRequest request=new SyncRequest();
  SyncRequestMetaData md=new SyncRequestMetaData();
  md.setApplicationToken(application.getApplicationToken());
  md.setEndpointPublicKeyHash(ByteBuffer.wrap(EndpointObjectHash.fromSHA1(ENDPOINT_KEY).getData()));
  request.setSyncRequestMetaData(md);
  ProfileSyncRequest profileSync=new ProfileSyncRequest(ByteBuffer.wrap(ENDPOINT_KEY),ByteBuffer.wrap(profile),new EndpointVersionInfo(CONF_SCHEMA_VERSION,PROFILE_SCHEMA_VERSION,1,1,null,1),null);
  request.setProfileSyncRequest(profileSync);
  request.setConfigurationSyncRequest(new ConfigurationSyncRequest());
  SyncResponse response=operationsService.sync(request).getResponse();
  Assert.assertNotNull(response);
  Assert.assertEquals(SyncResponseResultType.SUCCESS,response.getStatus());
  Assert.assertNotNull(response.getConfigurationSyncResponse());
  Assert.assertEquals(SyncResponseStatus.RESYNC,response.getConfigurationSyncResponse().getResponseStatus());
  Assert.assertEquals(APPLICATION_SEQ_NUMBER,(int)response.getConfigurationSyncResponse().getAppStateSeqNumber());
  Assert.assertNotNull(response.getConfigurationSyncResponse().getConfDeltaBody());
  Assert.assertNull(response.getConfigurationSyncResponse().getConfSchemaBody());
  response=operationsService.sync(request).getResponse();
  Assert.assertNotNull(response);
  Assert.assertEquals(SyncResponseResultType.SUCCESS,response.getStatus());
  Assert.assertNotNull(response.getConfigurationSyncResponse());
  Assert.assertEquals(SyncResponseStatus.RESYNC,response.getConfigurationSyncResponse().getResponseStatus());
  Assert.assertEquals(APPLICATION_SEQ_NUMBER,(int)response.getConfigurationSyncResponse().getAppStateSeqNumber());
  Assert.assertNotNull(response.getConfigurationSyncResponse().getConfDeltaBody());
  Assert.assertNull(response.getConfigurationSyncResponse().getConfSchemaBody());
}
