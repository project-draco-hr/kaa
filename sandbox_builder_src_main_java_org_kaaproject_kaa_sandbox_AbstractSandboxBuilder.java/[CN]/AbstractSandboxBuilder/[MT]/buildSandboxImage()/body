{
  if (boxLoaded()) {
    LOG.info("Box with name '{}' already exists. Going to unload old instance ...",boxName);
    if (boxRunning()) {
      stopBox();
    }
    unloadBox();
  }
  loadBox();
  try {
    prepareBox();
    startBox();
    provisionBox();
    schedulePackagesInstall();
    LOG.info("Executing Cassandra cql script...");
    scheduleSudoSshCommand("cqlsh -f " + CASSANDRA_INIT_SCRIPT);
    scheduleServicesStart();
    LOG.info("Executing remote ssh commands...");
    executeScheduledSshCommands();
    LOG.info("Remote ssh commands execution is completed.");
    LOG.info("Sleeping 80 sec.");
    Thread.sleep(80000);
    initBoxData();
    LOG.info("Sleeping 20 sec.");
    Thread.sleep(20000);
    unprovisionBox();
    stopBox();
    cleanupBox();
    exportBox();
  }
 catch (  Exception e) {
    LOG.error("Failed to build sandbox image!",e);
    dumpLogs();
    LOG.error("Look for sandbox build logs at: " + LOG_DUMP_LOCATION);
    throw e;
  }
 finally {
    if (boxLoaded()) {
      if (boxRunning()) {
        stopBox();
      }
    }
  }
}
