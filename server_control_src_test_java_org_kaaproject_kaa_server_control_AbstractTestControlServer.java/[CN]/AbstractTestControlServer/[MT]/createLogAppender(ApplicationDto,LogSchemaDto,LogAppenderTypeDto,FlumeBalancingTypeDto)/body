{
  LogAppenderDto appender=new LogAppenderDto();
  appender.setName(generateString("Test Schema"));
  appender.setDescription(generateString("Test Desc"));
  if (application == null) {
    application=createApplication();
  }
  appender.setApplicationId(application.getId());
  appender.setApplicationToken(application.getApplicationToken());
  appender.setTenantId(application.getTenantId());
  if (schema == null) {
    schema=createLogSchema(application.getId());
  }
  appender.setSchema(schema);
  appender.setStatus(LogAppenderStatusDto.REGISTERED);
  LogAppenderParametersDto parametersDto=new LogAppenderParametersDto();
  if (type == null) {
    type=LogAppenderTypeDto.FILE;
  }
 else   if (type.equals(LogAppenderTypeDto.FLUME)) {
    FlumeAppenderParametersDto flumeAppenderParametersDto=new FlumeAppenderParametersDto();
    flumeAppenderParametersDto.setBalancingType(balancingTypeDto != null ? balancingTypeDto : FlumeBalancingTypeDto.ROUND_ROBIN);
    flumeAppenderParametersDto.setHosts(Arrays.asList(new HostInfoDto("localhost",12121,0),new HostInfoDto("localhost",12122,0)));
    parametersDto.setParameters(flumeAppenderParametersDto);
  }
  appender.setProperties(parametersDto);
  LogAppenderDto savedLogAppender=toDto(client.editLogAppender(toDataStruct(appender)));
  return savedLogAppender;
}
