{
  if (zkEnabled) {
    ControlNodeInfo nodeInfo=new ControlNodeInfo();
    ConnectionInfo connectionInfo=new ConnectionInfo(host,port,host,0,null);
    nodeInfo.setConnectionInfo(connectionInfo);
    controlZKNode=new ControlNode(nodeInfo,zkHostPortList,60 * 1000,3 * 1000,new RetryUntilElapsed(zkMaxRetryTime,zkSleepTime));
    try {
      controlZKNode.start();
    }
 catch (    Exception e) {
      if (zkIgnoreErrors) {
        LOG.info("Failed to register control in ZooKeeper",e);
      }
 else {
        LOG.error("Failed to register control in ZooKeeper",e);
        throw new RuntimeException(e);
      }
    }
  }
}
