{
  LinkedList<EventMessage> messages=new LinkedList<>();
  OperationsThriftService.Iface client=null;
  while (operate) {
    try {
      EventMessage event=messageQueue.poll(1,TimeUnit.HOURS);
      if (event != null) {
        messages.push(event);
        messageQueue.drainTo(messages);
        client=getClient();
        client.sendEventMessage(messages);
        LOG.debug("EventWorker [{}:<{}>] {} messages sent",getId(),uniqueId,messages.size());
        messages.clear();
      }
    }
 catch (    TException te) {
      LOG.error("EventWorker [{}:{}] error sending event messages pack. ",getId(),uniqueId,te);
      eventService.notifyListenersOnServerProblem(getId());
    }
catch (    InterruptedException e) {
      LOG.info("EventWorker [{}<{}>] terminated: ",getId(),uniqueId,e);
      operate=false;
    }
  }
}
