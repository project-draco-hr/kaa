{
  mCustomContentVisible=enabled;
  if (mCustomContent != null && mCustomContentVisible) {
    if (mCustomContentViewWidth < mCustomContentMinWidth) {
      if (mToolbarCustomContentView.getChildCount() > 0) {
        mToolbarCustomContentView.removeAllViews();
      }
      if (mPopupContainer.getChildCount() == 0) {
        mPopupContainer.addView(mCustomContent,mCustomContentPopupViewLayoutParams);
        mPopupContainer.setCardBackgroundColor(mBackgroundColor);
      }
      int popupWidth=(int)(getWidth() * 0.7);
      if (mPopup == null) {
        mPopup=new PopupWindow(mPopupContainer,popupWidth,mCustomContentHeight,true);
        mPopup.setBackgroundDrawable(new ColorDrawable(Color.TRANSPARENT));
        mPopup.setOnDismissListener(new OnDismissListener(){
          @Override public void onDismiss(){
            mCustomContentVisible=false;
          }
        }
);
      }
 else {
        mPopup.setWidth(popupWidth);
      }
      PopupWindowCompat.showAsDropDown(mPopup,this,getWidth() - popupWidth,0,Gravity.TOP | Gravity.LEFT);
    }
 else {
      if (mPopupContainer.getChildCount() > 0) {
        mPopupContainer.removeAllViews();
      }
      if (mToolbarCustomContentView.getChildCount() == 0) {
        mToolbarCustomContentView.addView(mCustomContent,mCustomContentViewLayoutParams);
      }
    }
  }
  if (!mCustomContentVisible && mPopup != null && mPopup.isShowing()) {
    mPopup.dismiss();
  }
  if (mCustomContent != null) {
    mCustomContent.setVisibility(mCustomContentVisible ? View.VISIBLE : View.GONE);
  }
}
