{
  Map<String,Object> reportVals=(Map<String,Object>)row.getValue();
  List<Object> zones=(List<Object>)reportVals.get(ZONES_FIELD);
  Object timestampVal=reportVals.get(TIMESTAMP_FIELD);
  Long timestamp=timestampVal instanceof Number ? (Long)((Number)timestampVal).longValue() : (timestampVal instanceof String ? Long.parseLong((String)timestampVal) : null);
  List<DataPoint> dataPoints=new ArrayList<>();
  int sumPanelCount=0;
  for (  Object zoneObj : zones) {
    Map<String,Object> sample=(Map<String,Object>)zoneObj;
    int curPanelCount=(int)sample.get(COUNT_FIELD);
    DataPoint point=new DataPoint((int)sample.get(ZONE_ID_FIELD),curPanelCount * 1000,((Double)sample.get(SUM_FIELD)).floatValue());
    dataPoints.add(point);
    sumPanelCount+=curPanelCount;
  }
  return new DataReport(timestamp,dataPoints,getConsumption(sumPanelCount));
}
