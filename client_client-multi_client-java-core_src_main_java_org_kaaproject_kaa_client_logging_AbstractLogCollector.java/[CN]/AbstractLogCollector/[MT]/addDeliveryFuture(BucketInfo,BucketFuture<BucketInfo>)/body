{
synchronized (deliveryFuturesMap) {
    List<BucketFuture<BucketInfo>> deliveryFutures=deliveryFuturesMap.get(info.getBucketId());
    if (deliveryFutures == null) {
      deliveryFutures=new LinkedList<BucketFuture<BucketInfo>>();
      deliveryFuturesMap.put(info.getBucketId(),deliveryFutures);
    }
    deliveryFutures.add(future);
  }
}
