{
  CreateUserResult result=userFacade.saveUserDto(user,passwordEncoder);
  try {
    if (!isEmpty(result.getPassword())) {
      messagingService.sendTempPassword(user.getUsername(),result.getPassword(),user.getMail());
    }
  }
 catch (  Exception e) {
    userFacade.deleteUser(result.getUserId());
    throw Utils.handleException(e);
  }
  return result.getUserId();
}
