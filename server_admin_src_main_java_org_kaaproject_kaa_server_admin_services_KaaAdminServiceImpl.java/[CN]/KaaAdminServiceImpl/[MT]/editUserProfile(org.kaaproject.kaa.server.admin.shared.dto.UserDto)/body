{
  try {
    userDto.setExternalUid(getCurrentUser().getExternalUid());
    Long userId=saveUser(userDto);
    User user=userFacade.findById(userId);
    org.kaaproject.kaa.server.admin.shared.dto.UserDto result=new org.kaaproject.kaa.server.admin.shared.dto.UserDto(user.getId().toString(),user.getUsername(),user.getFirstName(),user.getLastName(),user.getMail(),KaaAuthorityDto.valueOf(user.getAuthorities().iterator().next().getAuthority()));
    return result;
  }
 catch (  Exception e) {
    throw Utils.handleException(e);
  }
}
