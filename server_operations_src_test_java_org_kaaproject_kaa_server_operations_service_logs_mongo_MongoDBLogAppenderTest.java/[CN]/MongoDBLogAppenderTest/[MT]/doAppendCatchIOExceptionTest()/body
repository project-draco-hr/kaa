{
  Logger testLogger=Mockito.mock(Logger.class);
  Field field=logAppender.getClass().getDeclaredField("LOG");
  field.setAccessible(true);
  Field modifiersField=Field.class.getDeclaredField("modifiers");
  modifiersField.setAccessible(true);
  modifiersField.setInt(field,field.getModifiers() & ~Modifier.FINAL);
  field.set(null,testLogger);
  List<LogEvent> events=new ArrayList<>();
  LogEvent event1=new LogEvent();
  event1.setLogData(LOG_DATA.getBytes(UTF_8));
  LogEvent event2=new LogEvent();
  event1.setLogData(LOG_DATA.getBytes(UTF_8));
  LogEvent event3=new LogEvent();
  event1.setLogData(LOG_DATA.getBytes(UTF_8));
  events.add(event1);
  events.add(event2);
  events.add(event3);
  List<LogSchemaDto> schemas=logSchemaService.findLogSchemasByAppId(applicationDto.getId());
  LogSchemaDto dto=schemas.get(0);
  LogSchema schema=new LogSchema(dto);
  int version=dto.getMajorVersion();
  LogEventPack logEventPack=new LogEventPack(ENDPOINT_KEY,DATE_CREATED,schema,events);
  logEventPack.setLogSchemaVersion(version);
  Map<String,ThreadLocal<GenericAvroConverter<GenericRecord>>> converters=new HashMap<>();
  GenericAvroConverter<GenericRecord> converter=new GenericAvroConverter<GenericRecord>(dto.getSchema()){
    @Override public GenericRecord decodeBinary(    byte[] bytes) throws IOException {
      throw new IOException();
    }
    @Override public String endcodeToJson(    GenericRecord record) throws IOException {
      throw new IOException();
    }
  }
;
  ThreadLocal<GenericAvroConverter<GenericRecord>> threadLocal=new ThreadLocal<GenericAvroConverter<GenericRecord>>();
  threadLocal.set(converter);
  converters.put(dto.getSchema(),threadLocal);
  ReflectionTestUtils.setField(logAppender,"converters",converters);
  logAppender.doAppend(logEventPack);
  Mockito.verify(testLogger).error(Mockito.anyString(),Mockito.any(IOException.class));
}
