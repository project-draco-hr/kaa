{
  this.readOnly=readOnly;
  this.hasErrorMessage=hasErrorMessage;
  FlexTable table=new FlexTable();
  recordCaption=new CaptionPanel();
  if (optional) {
    recordCaption.setCaptionText(title);
  }
 else {
    SpanElement span=Document.get().createSpanElement();
    span.appendChild(Document.get().createTextNode(title));
    span.addClassName("gwt-Label");
    span.addClassName(REQUIRED);
    recordCaption.setCaptionHTML(span.getString());
  }
  recordFieldWidget=new RecordFieldWidget(readOnly);
  recordCaption.setContentWidget(recordFieldWidget);
  recordCaption.setWidth("100%");
  table.setWidget(0,0,recordCaption);
  Label uploadLabel=new Label(Utils.constants.uploadFromFile());
  recordFileUpload=new FileUploadForm();
  recordFileUpload.addSubmitCompleteHandler(new SubmitCompleteHandler(){
    @Override public void onSubmitComplete(    SubmitCompleteEvent event){
      loadRecordFromFile();
    }
  }
);
  recordFileUpload.addChangeHandler(this);
  recordFileItemName=recordFileUpload.getFileItemName();
  uploadButton=new Button(Utils.constants.upload(),new ClickHandler(){
    @Override public void onClick(    ClickEvent event){
      recordFileUpload.submit();
    }
  }
);
  uploadButton.addStyleName(Utils.kaaAdminStyle.bAppButtonSmall());
  uploadButton.setEnabled(false);
  uploadTable=new FlexTable();
  uploadTable.setWidget(0,0,uploadLabel);
  uploadTable.setWidget(0,1,recordFileUpload);
  uploadTable.setWidget(0,2,uploadButton);
  uploadTable.getFlexCellFormatter().setVerticalAlignment(0,0,HasVerticalAlignment.ALIGN_MIDDLE);
  uploadTable.getFlexCellFormatter().setVerticalAlignment(0,2,HasVerticalAlignment.ALIGN_MIDDLE);
  table.setWidget(1,0,uploadTable);
  setWidget(table);
  setUploadVisible(!readOnly);
}
