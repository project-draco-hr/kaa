{
  AuthUserDto currentUser=this.getCurrentUser();
  if ((schema.getScope() != CTLSchemaScope.SYSTEM || currentUser.getAuthority() != KaaAuthorityDto.KAA_ADMIN) && (schema.getScope() == CTLSchemaScope.SYSTEM || !schema.getTenantId().equals(currentUser.getTenantId()))) {
    throw new KaaAdminServiceException("You do not have permission to perform this operation!",ServiceErrorCode.PERMISSION_DENIED);
  }
}
