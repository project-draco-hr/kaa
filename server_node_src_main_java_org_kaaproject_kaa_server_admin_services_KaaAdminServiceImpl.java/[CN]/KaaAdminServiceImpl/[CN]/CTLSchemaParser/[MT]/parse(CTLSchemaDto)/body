{
  Map<String,Schema> types=new HashMap<>();
  if (schema.getDependencies() != null) {
    for (    CTLDependencyDto dependency : schema.getDependencies()) {
      try {
        CTLSchemaDto dependencySchema=controlService.getCTLSchemaByFqnVersionAndTenantId(dependency.getFqn(),dependency.getVersion(),getCurrentUser().getTenantId());
        types.put(dependency.getFqn(),this.parse(dependencySchema));
      }
 catch (      Exception cause) {
        throw new IllegalArgumentException("Unable to locate dependency " + dependency.toString());
      }
    }
  }
  try {
    return this.parser.addTypes(types).parse(schema.getBody());
  }
 catch (  Exception cause) {
    throw new IllegalArgumentException("Unable to parse CTL schema: " + cause.getMessage());
  }
}
