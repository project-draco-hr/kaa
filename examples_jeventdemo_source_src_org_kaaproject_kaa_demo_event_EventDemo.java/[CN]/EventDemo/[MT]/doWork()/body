{
  List<String> FQNs=new LinkedList<>();
  FQNs.add(ThermostatInfoRequest.class.getName());
  FQNs.add(ChangeDegreeRequest.class.getName());
  EventListenersResolver eventListenersResolver=kaaClient.getEventListenerResolver();
  eventListenersResolver.findEventListeners(FQNs,new FetchEventListeners(){
    @Override public void onEventListenersReceived(    List<String> eventListeners){
      LOG.info("{} event listeners received",eventListeners.size());
      for (      String listener : eventListeners) {
        LOG.info("listener: {}",listener);
      }
    }
    @Override public void onRequestFailed(){
      LOG.info("Request failed");
    }
  }
);
  EventFamilyFactory eventFamilyFactory=kaaClient.getEventFamilyFactory();
  ThermostatEventClassFamily tecf=eventFamilyFactory.getThermostatEventClassFamily();
  tecf.addListener(new DefaultEventFamilyListener(){
    @Override public void onEvent(    ChangeDegreeRequest arg0,    String arg1){
      LOG.info("ChangeDegreeRequest event fired!");
    }
    @Override public void onEvent(    ThermostatInfoResponse arg0,    String arg1){
      LOG.info("ThermostatInfoResponse event fired!");
    }
    @Override public void onEvent(    ThermostatInfoRequest arg0,    String arg1){
      LOG.info("ThermostatInfoRequest event fired!");
    }
  }
);
  tecf.sendEventToAll(new ChangeDegreeRequest(10));
  LOG.info("ChangeDegreeRequest sent");
  TransactionId trxId=eventFamilyFactory.startEventsBlock();
  tecf.addEventToBlock(trxId,new ThermostatInfoRequest());
  tecf.addEventToBlock(trxId,new ChangeDegreeRequest(-30),"home_thermostat");
  eventFamilyFactory.submitEventsBlock(trxId);
  try {
    System.in.read();
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
  kaaClient.stop();
  LOG.info("Event demo stopped");
}
