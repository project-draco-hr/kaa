{
  KaaClient kaaClient=Kaa.newClient(new DesktopKaaPlatformContext(),new SimpleKaaClientStateListener());
  kaaClient.start();
  EndpointRegistrationManager registrationManager=kaaClient.getEndpointRegistrationManager();
  registrationManager.attachUser("userExternalId","userAccessToken",new UserAttachCallback(){
    @Override public void onAttachResult(    UserAttachResponse response){
      System.out.println("Attach response" + response.getResult());
    }
  }
);
  EventFamilyFactory eventFamilyFactory=kaaClient.getEventFamilyFactory();
  ThermoEventClassFamily tecf=eventFamilyFactory.getThermoEventClassFamily();
  List<String> FQNs=new LinkedList<>();
  FQNs.add("org.kaaproject.kaa.schema.sample.thermo.ThermostatInfoRequest");
  FQNs.add("org.kaaproject.kaa.schema.sample.thermo.ChangeTemperatureCommand");
  EventListenersResolver eventListenersResolver=kaaClient.getEventListenerResolver();
  eventListenersResolver.findEventListeners(FQNs,new FetchEventListeners(){
    @Override public void onRequestFailed(){
    }
    @Override public void onEventListenersReceived(    List<String> eventListeners){
    }
  }
);
  tecf.sendEventToAll(new ThermostatInfoRequest());
  tecf.addListener(new DefaultEventFamilyListener(){
    @Override public void onEvent(    ChangeDegreeRequest arg0,    String arg1){
    }
    @Override public void onEvent(    ThermostatInfoResponse arg0,    String arg1){
    }
    @Override public void onEvent(    ThermostatInfoRequest arg0,    String arg1){
    }
  }
);
  try {
    System.in.read();
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
  kaaClient.stop();
}
