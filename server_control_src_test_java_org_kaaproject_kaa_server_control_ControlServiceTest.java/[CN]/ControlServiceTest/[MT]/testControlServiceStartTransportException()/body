{
  ControlServiceImpl controlService=controlServiceSpy();
  TThreadPoolServer server=Mockito.mock(TThreadPoolServer.class);
  Mockito.doThrow(TTransportException.class).when(server).serve();
  Mockito.doReturn(server).when(controlService).createServer(Mockito.any(TServerTransport.class),Mockito.any(ControlThriftService.Processor.class));
  controlService.start();
}
