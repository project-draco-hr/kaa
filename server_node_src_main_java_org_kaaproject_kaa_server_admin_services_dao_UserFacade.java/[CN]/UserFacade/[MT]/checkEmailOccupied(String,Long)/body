{
  TypedQuery<User> query;
  if (userId != null) {
    query=em.createQuery("SELECT u FROM User u WHERE u.mail = :mail AND u.id != :userId",User.class);
    query.setParameter("userId",userId);
  }
 else {
    query=em.createQuery("SELECT u FROM User u WHERE u.mail = :mail",User.class);
  }
  query.setParameter("mail",mail);
  List<User> resultList=query.getResultList();
  if (!resultList.isEmpty()) {
    return resultList.get(0);
  }
 else {
    return null;
  }
}
