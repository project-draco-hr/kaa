{
  Runnable thriftRunnable=new Runnable(){
    @Override public void run(){
      LOG.info("Initializing Thrift Service for Control Server....");
      LOG.info("host: " + host);
      LOG.info("port: " + port);
      try {
        ControlThriftService.Processor<ControlThriftService.Iface> processor=new ControlThriftService.Processor<ControlThriftService.Iface>(controlService);
        TServerTransport serverTransport=createServerSocket();
        server=createServer(serverTransport,processor);
        LOG.info("Thrift Control Server Started.");
        thriftStartupLatch.countDown();
        server.serve();
        if (executorService != null && !executorService.isTerminated()) {
          for (          TSocketWrapper socket : new ArrayList<>(openedSockets)) {
            if (socket.getSocket() != null && !socket.getSocket().isClosed()) {
              socket.close();
            }
          }
          LOG.info("Terminating executor service.");
          executorService.shutdownNow();
        }
        LOG.info("Thrift Control Server Stopped.");
        thriftShutdownLatch.countDown();
      }
 catch (      TTransportException e) {
        LOG.error("TTransportException",e);
      }
 finally {
        if (thriftStartupLatch.getCount() > 0) {
          thriftStartupLatch.countDown();
        }
        if (thriftShutdownLatch.getCount() > 0) {
          LOG.info("Thrift Control Server Stopped.");
          thriftShutdownLatch.countDown();
        }
      }
    }
  }
;
  new Thread(thriftRunnable).start();
}
