{
  LOG.info("Initializing Thrift Service for Control Server....");
  LOG.info("host: " + host);
  LOG.info("port: " + port);
  try {
    ControlThriftService.Processor<ControlThriftService.Iface> processor=new ControlThriftService.Processor<ControlThriftService.Iface>(controlService);
    TServerTransport serverTransport=createServerSocket();
    server=createServer(serverTransport,processor);
    LOG.info("Control Server Started.");
    server.serve();
    if (executorService != null && !executorService.isTerminated()) {
      for (      TSocketWrapper socket : new ArrayList<>(openedSockets)) {
        if (socket.getSocket() != null && !socket.getSocket().isClosed()) {
          socket.close();
        }
      }
      LOG.info("Terminating executor service.");
      executorService.shutdownNow();
    }
    LOG.info("Control Server Stopped.");
  }
 catch (  TTransportException e) {
    LOG.error("TTransportException",e);
  }
}
