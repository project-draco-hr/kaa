{
  LogBlock logBlock=null;
synchronized (buckets) {
    if (!buckets.isEmpty()) {
      if (maxBucketSize != blockSize) {
        resize(blockSize);
      }
      for (      Bucket bucket : buckets) {
        if (!bucket.isUsed()) {
          bucket.setUsage(true);
          logBlock=new LogBlock(bucket.getId(),bucket.getRecords());
          LOG.trace("Formed log block with id: {}, records: {}",logBlock.getBlockId(),logBlock.getRecords().size());
          break;
        }
      }
    }
  }
  return logBlock;
}
