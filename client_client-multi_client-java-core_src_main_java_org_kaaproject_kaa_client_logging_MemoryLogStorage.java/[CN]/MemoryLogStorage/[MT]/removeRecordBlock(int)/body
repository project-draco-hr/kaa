{
synchronized (buckets) {
    LOG.trace("Removing log group by id: {}",id);
    boolean isFound=false;
    if (!buckets.isEmpty()) {
      Iterator<Bucket> it=buckets.iterator();
      while (it.hasNext()) {
        Bucket bucket=it.next();
        if (bucket.getId() == id && bucket.isUsed()) {
          consumedSize-=bucket.getConsumedSize();
          recordCount-=bucket.getRecords().size();
          isFound=true;
          LOG.trace("Successfully removed log group by id {}, removed: {}, in storage: {}",bucket.getId(),bucket.getRecords().size(),recordCount);
          it.remove();
          break;
        }
      }
    }
    if (!isFound) {
      LOG.warn("Failed to remove log group: unknown id {}, records: {}",id);
    }
  }
}
