{
  Runnable readTask=new Runnable(){
    byte[] buffer=new byte[1024];
    @Override public void run(){
      while (!Thread.currentThread().isInterrupted()) {
        try {
          LOG.info("reading data from stream using [{}] byte buffer",buffer.length);
          int size=socket.getInputStream().read(buffer);
          LOG.info("read data {} bytes from stream",size);
          if (size > 0) {
            messageFactory.getFramer().pushBytes(Arrays.copyOf(buffer,size));
          }
 else           if (size == -1) {
            LOG.info("received end of stream",size);
            break;
          }
        }
 catch (        IOException|KaaTcpProtocolException|RuntimeException e) {
          if (!Thread.currentThread().isInterrupted()) {
            LOG.error("Failed to read from the socket for channel",e);
          }
 else {
            LOG.info("Socket connection was interrupted");
          }
        }
      }
      LOG.info("Read Task is interrupted");
    }
  }
;
  return readTask;
}
