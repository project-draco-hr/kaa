{
  T field=null;
switch (type) {
case STRING:
    field=(T)new StringField(fieldName,displayName,optional);
  break;
case ARRAY:
field=(T)new ArrayField(fieldName,displayName,optional);
break;
case BOOLEAN:
field=(T)new BooleanField(fieldName,displayName,optional);
break;
case ENUM:
field=(T)new EnumField(fieldName,displayName,optional);
break;
case INTEGER:
field=(T)new IntegerField(fieldName,displayName,optional);
break;
case LONG:
field=(T)new LongField(fieldName,displayName,optional);
break;
case RECORD:
field=(T)new RecordField(fieldName,displayName,optional);
break;
case UNION:
field=(T)new UnionField(fieldName,displayName,optional);
break;
default :
break;
}
return field;
}
