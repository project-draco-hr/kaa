{
  String reuseTsValue=null;
  Insert[] insertArray=new Insert[logEventDtoList.size()];
  GenericRecord clientProfile=clientProfileConverter.decodeJson(clientProfileJson);
  ByteBuffer clientProfileBinary=ByteBuffer.wrap(clientProfileConverter.encode(clientProfile));
  GenericRecord serverProfile=serverProfileConverter.decodeJson(serverProfileJson);
  ByteBuffer serverProfileBinary=ByteBuffer.wrap(serverProfileConverter.encode(serverProfile));
  for (int i=0; i < logEventDtoList.size(); i++) {
    CassandraLogEventDto dto=logEventDtoList.get(i);
    Insert insert=QueryBuilder.insertInto(keyspaceName,collectionName);
    for (    ColumnMappingElement element : configuration.getColumnMapping()) {
switch (element.getType()) {
case HEADER_FIELD:
        insert.value(element.getColumnName(),formatField(element.getColumnType(),dto.getHeader().get(element.getValue())));
      break;
case EVENT_FIELD:
    insert.value(element.getColumnName(),formatField(element.getColumnType(),dto.getEvent().get(element.getValue())));
  break;
case CLIENT_FIELD:
insert.value(element.getColumnName(),formatField(element.getColumnType(),clientProfile.get(element.getValue())));
case SERVER_FIELD:
insert.value(element.getColumnName(),formatField(element.getColumnType(),serverProfile.get(element.getValue())));
case HEADER_JSON:
insert.value(element.getColumnName(),headerConverter.encodeToJson(dto.getHeader()));
break;
case HEADER_BINARY:
insert.value(element.getColumnName(),ByteBuffer.wrap(headerConverter.encode(dto.getHeader())));
break;
case EVENT_JSON:
insert.value(element.getColumnName(),eventConverter.encodeToJson(dto.getEvent()));
break;
case EVENT_BINARY:
insert.value(element.getColumnName(),ByteBuffer.wrap(eventConverter.encode(dto.getEvent())));
break;
case CLIENT_JSON:
insert.value(element.getColumnName(),clientProfileJson);
break;
case CLIENT_BINARY:
insert.value(element.getColumnName(),clientProfileBinary);
break;
case SERVER_JSON:
insert.value(element.getColumnName(),serverProfileJson);
break;
case SERVER_BINARY:
insert.value(element.getColumnName(),serverProfileBinary);
break;
case UUID:
insert.value(element.getColumnName(),UUID.randomUUID());
break;
case TS:
reuseTsValue=formatTs(reuseTsValue,element);
insert.value(element.getColumnName(),reuseTsValue);
break;
}
}
insert.using(QueryBuilder.ttl(configuration.getDataTTL()));
insertArray[i]=insert;
}
return insertArray;
}
