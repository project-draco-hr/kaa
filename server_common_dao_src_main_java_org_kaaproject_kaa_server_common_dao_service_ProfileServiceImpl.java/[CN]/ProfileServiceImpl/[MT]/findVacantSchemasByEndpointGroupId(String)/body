{
  validateId(endpointGroupId,"Can't find vacant schemas. Invalid endpoint group id: " + endpointGroupId);
  EndpointGroup group=endpointGroupDao.findById(endpointGroupId);
  List<ProfileFilter> profileFilters=profileFilterDao.findActualByEndpointGroupId(endpointGroupId);
  List<String> usedSchemaIds=new ArrayList<>();
  for (  ProfileFilter filter : profileFilters) {
    usedSchemaIds.add(filter.getSchemaId());
  }
  List<EndpointProfileSchema> schemas=profileSchemaDao.findVacantSchemas(group.getApplicationId(),usedSchemaIds);
  List<ProfileVersionPairDto> schemaDtoList=new ArrayList<>();
  for (  EndpointProfileSchema schema : schemas) {
    schemaDtoList.add(schema.toVersionDto());
  }
  return schemaDtoList;
}
