{
  Collection<ProfileFilterDto> profileFilters=convertDtoList(profileFilterDao.findActualByEndpointGroupId(endpointGroupId));
  List<StructureRecordDto<ProfileFilterDto>> records=StructureRecordDto.convertToRecords(profileFilters);
  if (includeDeprecated) {
    List<ProfileVersionPairDto> schemas=findVacantSchemasByEndpointGroupId(endpointGroupId);
    for (    ProfileVersionPairDto schema : schemas) {
      ProfileFilterDto deprecatedProfileFilter=getDto(profileFilterDao.findLatestDeprecated(schema.getId(),endpointGroupId));
      if (deprecatedProfileFilter != null) {
        StructureRecordDto<ProfileFilterDto> record=new StructureRecordDto<>();
        record.setActiveStructureDto(deprecatedProfileFilter);
        records.add(record);
      }
    }
  }
  Collections.sort(records);
  return records;
}
