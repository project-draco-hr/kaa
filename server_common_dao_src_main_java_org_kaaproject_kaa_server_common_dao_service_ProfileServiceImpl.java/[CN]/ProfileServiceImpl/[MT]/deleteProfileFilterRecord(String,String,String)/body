{
  ChangeProfileFilterNotification profileNotification=null;
  validateId(schemaId,"Incorrect profile schema id " + schemaId + ".");
  validateId(groupId,"Incorrect group id " + groupId + ".");
  ProfileFilterDto profileFilterDto=getDto(profileFilterDao.deactivateOldFilter(schemaId.toString(),groupId.toString(),deactivatedUsername));
  if (profileFilterDto != null) {
    HistoryDto historyDto=addHistory(profileFilterDto,ChangeType.REMOVE_PROF);
    ChangeNotificationDto changeNotificationDto=createNotification(profileFilterDto,historyDto);
    profileNotification=new ChangeProfileFilterNotification();
    profileNotification.setProfileFilterDto(profileFilterDto);
    profileNotification.setChangeNotificationDto(changeNotificationDto);
  }
  ProfileFilter profileFilter=profileFilterDao.findInactiveFilter(schemaId,groupId);
  if (profileFilter != null) {
    profileFilterDao.removeById(profileFilter.getId());
  }
  return profileNotification;
}
