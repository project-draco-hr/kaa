{
  LOG.trace("Applying failover strategy for status: {}",failoverStatus);
switch (failoverStatus) {
case BOOTSTRAP_SERVERS_NA:
    AccessPointIdResolution bootstrapResolution=resolutionProgressMap.get(ServerType.BOOTSTRAP);
  if (bootstrapResolution != null) {
    bootstrapResolution.setResolutionTime(System.currentTimeMillis() + TimeUnit.MILLISECONDS.convert(bootstrapServersRetryPeriod,timeUnit));
  }
return new FailoverDecision(FailoverAction.RETRY,bootstrapServersRetryPeriod,timeUnit);
case NO_OPERATION_SERVERS_RECEIVED:
bootstrapResolution=resolutionProgressMap.get(ServerType.BOOTSTRAP);
if (bootstrapResolution != null) {
bootstrapResolution.setResolutionTime(System.currentTimeMillis());
}
return new FailoverDecision(FailoverAction.USE_NEXT_BOOTSTRAP,bootstrapServersRetryPeriod,timeUnit);
case OPERATION_SERVERS_NA:
AccessPointIdResolution operationsResolution=resolutionProgressMap.get(ServerType.OPERATIONS);
if (operationsResolution != null) {
operationsResolution.setResolutionTime(System.currentTimeMillis() + TimeUnit.MILLISECONDS.convert(operationsServersRetryPeriod,timeUnit));
}
return new FailoverDecision(FailoverAction.RETRY,operationsServersRetryPeriod,timeUnit);
case NO_CONNECTIVITY:
return new FailoverDecision(FailoverAction.RETRY,noConnectivityRetryPeriod,timeUnit);
default :
return new FailoverDecision(FailoverAction.NOOP);
}
}
