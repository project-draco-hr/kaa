{
  OperationsNodeInfo nodeInfo=new OperationsNodeInfo();
  ByteBuffer keyData=ByteBuffer.wrap(keyStoreService.getPublicKey().getEncoded());
  nodeInfo.setConnectionInfo(new ConnectionInfo(getConfig().getThriftHost(),getConfig().getThriftPort(),keyData));
  nodeInfo.setLoadInfo(new LoadInfo(DEFAULT_LOAD_INDEX));
  nodeInfo.setTransports(new ArrayList<TransportMetaData>());
  operationsNode=new OperationsNode(nodeInfo,getConfig().getZkHostPortList(),new RetryUntilElapsed(getConfig().getZkMaxRetryTime(),getConfig().getZkSleepTime()));
  try {
    operationsNode.start();
    eventService.setZkNode(operationsNode);
    eventService.setResolver(new ConsistentHashResolver(operationsNode.getCurrentOperationServerNodes(),getConfig().getUserHashPartitions()));
  }
 catch (  Exception e) {
    if (getConfig().isZkIgnoreErrors()) {
      LOG.info("Failed to register operations in ZooKeeper",e);
    }
 else {
      LOG.error("Failed to register operations in ZooKeeper",e);
      throw new RuntimeException(e);
    }
  }
}
