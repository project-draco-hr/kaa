{
  OperationsNodeInfo nodeInfo=new OperationsNodeInfo();
  ByteBuffer keyData=ByteBuffer.wrap(keyStoreService.getPublicKey().getEncoded());
  ConnectionInfo connectionInfo=new ConnectionInfo(getConfig().getThriftHost(),getConfig().getThriftPort(),keyData);
  nodeInfo.setConnectionInfo(connectionInfo);
  List<SupportedChannel> suppChannels=new ArrayList<>();
  for (  ServiceChannel sc : nettyServersList) {
    try {
      suppChannels.add(sc.getZkSupportedChannel());
    }
 catch (    ZkChannelException e) {
      LOG.error("Error advertize Channel ",e);
    }
  }
  nodeInfo.setSupportedChannelsArray(suppChannels);
  operationsNode=new OperationsNode(nodeInfo,getConfig().getZkHostPortList(),new RetryUntilElapsed(getConfig().getZkMaxRetryTime(),getConfig().getZkSleepTime()));
  try {
    operationsNode.start();
    eventService.setZkNode(operationsNode);
  }
 catch (  Exception e) {
    if (getConfig().isZkIgnoreErrors()) {
      LOG.info("Failed to register operations in ZooKeeper",e);
    }
 else {
      LOG.error("Failed to register operations in ZooKeeper",e);
      throw new RuntimeException(e);
    }
  }
}
