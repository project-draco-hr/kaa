{
  Runnable thriftRunnable=new Runnable(){
    @Override public void run(){
      LOG.info("Initializing Thrift Service for Operations Server....");
      LOG.info("thrift host: {}",getConfig().getThriftHost());
      LOG.info("thrift port: {}",getConfig().getThriftPort());
      try {
        OperationsThriftService.Processor<OperationsThriftService.Iface> processor=new OperationsThriftService.Processor<OperationsThriftService.Iface>(operationsThriftService);
        TServerTransport serverTransport=new TServerSocket(new InetSocketAddress(getConfig().getThriftHost(),getConfig().getThriftPort()));
        TThreadPoolServer.Args args=new Args(serverTransport).processor(processor);
        args.stopTimeoutVal=3;
        args.stopTimeoutUnit=TimeUnit.SECONDS;
        server=new TThreadPoolServer(args);
        LOG.info("Thrift Operations Server Started.");
        thriftStartupLatch.countDown();
        server.serve();
        LOG.info("Thrift Operations Server Stopped.");
        thriftShutdownLatch.countDown();
      }
 catch (      TTransportException e) {
        LOG.error("TTransportException",e);
      }
 finally {
        if (thriftStartupLatch.getCount() > 0) {
          thriftStartupLatch.countDown();
        }
        if (thriftShutdownLatch.getCount() > 0) {
          LOG.info("Thrift Operations Server Stopped.");
          thriftShutdownLatch.countDown();
        }
      }
    }
  }
;
  new Thread(thriftRunnable).start();
}
